{"id":"loc-0fm","title":"Add .pnpm-store and other cache directories to skip list","description":"## Context\nThe walker in `internal/scanner/walker.go` only skips .git, vendor, node_modules.\n\nOn sageox-mono, this misses:\n- `.pnpm-store` - 75k content-addressable files (93% of all files scanned!)\n- `.terraform` - terraform module cache\n- `.husky` - git hooks\n- Other hidden directories that should be skipped\n\n## Implementation\n1. Add to skip list in `Walk()` function:\n   - `.pnpm-store`\n   - `.terraform`\n   - `.husky`\n   - `.nx` (nx cache)\n   - `.turbo` (turborepo cache)\n   - `.next` (Next.js build)\n   - `.nuxt` (Nuxt build)\n   - `.cache` (general cache)\n   - `__pycache__` (Python)\n   - `.venv` / `venv` (Python virtualenv)\n   - `.yarn` (Yarn PnP)\n\n2. Consider making this configurable via aloc.yaml\n\n## Expected Impact\nThis single change should reduce file count from 80k to ~5k, yielding ~16x speedup.","status":"closed","priority":0,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:01:29.795141-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:26.169721-08:00","closed_at":"2026-01-17T12:49:26.169721-08:00","close_reason":"Implemented: skip directories, extension filtering, single file open, --deep flag. Performance improved from 15s to 0.5s (29x speedup)"}
{"id":"loc-0tc","title":"Epic: Project Foundation \u0026 Model Layer","description":"Foundation work including project scaffolding, Go module setup, and core domain types (Role, Signal, TestKind enums, RawFile, FileRecord, Report structs). This is the base layer that all other components depend on.\n\n## Scope\n- Project directory structure\n- Go module initialization\n- Core type definitions in internal/model/\n- JSON serialization tags\n- Unit tests for type serialization\n\n## Design References\n- docs/architecture.md (Package Structure section)\n- docs/design/json-schema.md (Field Definitions)\n\n## Acceptance Criteria\n- [ ] Directory structure matches architecture doc\n- [ ] All Role, Signal, TestKind enums defined\n- [ ] RawFile, FileRecord, Report structs compile\n- [ ] JSON round-trip tests pass\n- [ ] go mod tidy succeeds","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:00.346819-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.808836-08:00","closed_at":"2026-01-17T12:50:15.808836-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-0tc.1","title":"Create project directory structure and go.mod","description":"Initialize the Go module and create the complete directory structure.\n\n## Directory Structure\n```\nlloc/\n├── cmd/lloc/main.go        # placeholder main\n├── internal/\n│   ├── scanner/            # empty dirs\n│   ├── inference/\n│   ├── model/\n│   ├── aggregator/\n│   └── renderer/\n│       ├── tui/\n│       ├── json/\n│       └── html/\n├── pkg/config/\n├── testdata/\n├── go.mod\n└── go.sum\n```\n\n## Implementation\n1. Create all directories\n2. Run `go mod init github.com/[org]/lloc`\n3. Create placeholder main.go with hello world\n4. Verify `go build ./...` succeeds\n\n## Acceptance Criteria\n- [ ] All directories exist\n- [ ] go mod init succeeds\n- [ ] go build ./... succeeds\n- [ ] Placeholder main runs","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:56:16.867986-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T06:56:16.867986-08:00","dependencies":[{"issue_id":"loc-0tc.1","depends_on_id":"loc-0tc","type":"parent-child","created_at":"2026-01-17T06:56:16.874055-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-0tc.2","title":"Define Role, Signal, TestKind enums in model/types.go","description":"Create the core enumeration types for semantic classification.\n\n## File: internal/model/types.go\n\n```go\npackage model\n\ntype Role string\n\nconst (\n    RoleProd       Role = \"prod\"\n    RoleTest       Role = \"test\"\n    RoleInfra      Role = \"infra\"\n    RoleDocs       Role = \"docs\"\n    RoleConfig     Role = \"config\"\n    RoleGenerated  Role = \"generated\"\n    RoleVendor     Role = \"vendor\"\n    RoleScripts    Role = \"scripts\"\n    RoleExamples   Role = \"examples\"\n    RoleDeprecated Role = \"deprecated\"\n)\n\n// AllRoles for iteration\nvar AllRoles = []Role{...}\n\ntype TestKind string\n\nconst (\n    TestUnit        TestKind = \"unit\"\n    TestIntegration TestKind = \"integration\"\n    TestE2E         TestKind = \"e2e\"\n    TestContract    TestKind = \"contract\"\n    TestFixture     TestKind = \"fixture\"\n)\n\ntype Signal string\n\nconst (\n    SignalPath         Signal = \"path\"\n    SignalFilename     Signal = \"filename\"\n    SignalExtension    Signal = \"extension\"\n    SignalNeighborhood Signal = \"neighborhood\"\n    SignalHeader       Signal = \"header\"\n    SignalOverride     Signal = \"override\"\n)\n```\n\n## Design Reference\n- docs/design/json-schema.md (Semantic Role Vocabulary section)\n\n## Acceptance Criteria\n- [ ] All roles defined\n- [ ] All test kinds defined\n- [ ] All signals defined\n- [ ] AllRoles slice for iteration\n- [ ] Code compiles","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:56:27.229004-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T06:56:27.229004-08:00","dependencies":[{"issue_id":"loc-0tc.2","depends_on_id":"loc-0tc","type":"parent-child","created_at":"2026-01-17T06:56:27.230006-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-0tc.3","title":"Define RawFile and FileRecord structs in model/file.go","description":"Create the file-level data structures.\n\n## File: internal/model/file.go\n\n```go\npackage model\n\n// RawFile is the scanner output before semantic inference\ntype RawFile struct {\n    Path         string\n    Bytes        int64\n    LOC          int\n    LanguageHint string\n}\n\n// FileRecord is a file with semantic classification\ntype FileRecord struct {\n    Path       string    `json:\"path\"`\n    LOC        int       `json:\"loc\"`\n    Language   string    `json:\"language\"`\n    Role       Role      `json:\"role\"`\n    SubRole    TestKind  `json:\"sub_role,omitempty\"`\n    Confidence float32   `json:\"confidence\"`\n    Signals    []Signal  `json:\"signals\"`\n}\n```\n\n## Design Reference\n- docs/design/json-schema.md (files[] section)\n\n## Acceptance Criteria\n- [ ] RawFile struct defined\n- [ ] FileRecord struct defined with JSON tags\n- [ ] SubRole is omitempty\n- [ ] Code compiles","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:56:35.252013-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T06:56:35.252013-08:00","dependencies":[{"issue_id":"loc-0tc.3","depends_on_id":"loc-0tc","type":"parent-child","created_at":"2026-01-17T06:56:35.253107-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-0tc.4","title":"Define Report, Summary, Responsibility, Ratios structs in model/report.go","description":"Create the aggregate report data structures that match the JSON schema.\n\n## File: internal/model/report.go\n\n```go\npackage model\n\nimport \"time\"\n\ntype Report struct {\n    Meta             Meta              `json:\"meta\"`\n    Summary          Summary           `json:\"summary\"`\n    Responsibilities []Responsibility  `json:\"responsibilities\"`\n    Ratios           Ratios            `json:\"ratios\"`\n    Languages        []LanguageComp    `json:\"languages\"`\n    Trend            *Trend            `json:\"trend,omitempty\"`\n    Confidence       ConfidenceInfo    `json:\"confidence\"`\n    Files            []FileRecord      `json:\"files,omitempty\"`\n}\n\ntype Meta struct {\n    SchemaVersion    string    `json:\"schema_version\"`\n    GeneratedAt      time.Time `json:\"generated_at\"`\n    Generator        string    `json:\"generator\"`\n    GeneratorVersion string    `json:\"generator_version\"`\n    Repo             *RepoInfo `json:\"repo,omitempty\"`\n}\n\ntype RepoInfo struct {\n    Name   string `json:\"name,omitempty\"`\n    Commit string `json:\"commit,omitempty\"`\n    Branch string `json:\"branch,omitempty\"`\n    Root   string `json:\"root,omitempty\"`\n}\n\ntype Summary struct {\n    Files     int `json:\"files\"`\n    LOCTotal  int `json:\"loc_total\"`\n    Languages int `json:\"languages\"`\n}\n\ntype Responsibility struct {\n    Role       Role               `json:\"role\"`\n    LOC        int                `json:\"loc\"`\n    Files      int                `json:\"files\"`\n    Confidence float32            `json:\"confidence\"`\n    Breakdown  map[TestKind]float32 `json:\"breakdown,omitempty\"`\n    Notes      []string           `json:\"notes,omitempty\"`\n}\n\ntype Ratios struct {\n    TestToProd      float32 `json:\"test_to_prod\"`\n    InfraToProd     float32 `json:\"infra_to_prod\"`\n    DocsToProd      float32 `json:\"docs_to_prod\"`\n    GeneratedToProd float32 `json:\"generated_to_prod\"`\n    ConfigToProd    float32 `json:\"config_to_prod\"`\n}\n\ntype LanguageComp struct {\n    Language         string         `json:\"language\"`\n    LOCTotal         int            `json:\"loc_total\"`\n    Files            int            `json:\"files\"`\n    Responsibilities map[Role]int   `json:\"responsibilities\"`\n}\n\ntype Trend struct {\n    Window         string    `json:\"window\"`\n    Sparkline      []float32 `json:\"sparkline\"`\n    Direction      string    `json:\"direction\"`\n    Interpretation string    `json:\"interpretation\"`\n}\n\ntype ConfidenceInfo struct {\n    AutoClassified float32 `json:\"auto_classified\"`\n    Heuristic      float32 `json:\"heuristic\"`\n    Override       float32 `json:\"override\"`\n}\n```\n\n## Design Reference\n- docs/design/json-schema.md (complete schema)\n\n## Acceptance Criteria\n- [ ] All structs match JSON schema\n- [ ] All JSON tags correct\n- [ ] Optional fields use omitempty\n- [ ] Code compiles","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:56:50.614364-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:32.002462-08:00","closed_at":"2026-01-17T12:25:32.002462-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-0tc.4","depends_on_id":"loc-0tc","type":"parent-child","created_at":"2026-01-17T06:56:50.616188-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-0tc.5","title":"Add unit tests for model JSON serialization","description":"Test that all model types serialize to JSON correctly and round-trip without data loss.\n\n## File: internal/model/types_test.go, file_test.go, report_test.go\n\n## Tests Required\n1. Role enum serializes to lowercase string\n2. Signal enum serializes correctly\n3. TestKind enum serializes correctly\n4. FileRecord JSON round-trip preserves all fields\n5. Report JSON round-trip preserves all fields\n6. omitempty fields are actually omitted when empty\n7. time.Time serializes to ISO 8601\n\n## Example Test\n```go\nfunc TestFileRecordJSONRoundTrip(t *testing.T) {\n    original := FileRecord{\n        Path:       \"internal/auth/login.go\",\n        LOC:        412,\n        Language:   \"Go\",\n        Role:       RoleProd,\n        Confidence: 0.94,\n        Signals:    []Signal{SignalPath, SignalExtension},\n    }\n\n    data, err := json.Marshal(original)\n    require.NoError(t, err)\n\n    var decoded FileRecord\n    err = json.Unmarshal(data, \u0026decoded)\n    require.NoError(t, err)\n\n    assert.Equal(t, original, decoded)\n}\n```\n\n## Acceptance Criteria\n- [ ] All types have serialization tests\n- [ ] Round-trip tests pass\n- [ ] omitempty behavior verified\n- [ ] go test ./internal/model/... passes","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:00.554066-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:32.003969-08:00","closed_at":"2026-01-17T12:25:32.003969-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-0tc.5","depends_on_id":"loc-0tc","type":"parent-child","created_at":"2026-01-17T06:57:00.555039-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-2qi","title":"Submit aloc to ratatui/awesome-ratatui","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:44:03.142218-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.815231-08:00","closed_at":"2026-02-01T11:47:38.815231-08:00","close_reason":"PRs submitted"}
{"id":"loc-3tj","title":"Submit aloc to rothgar/awesome-tuis","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:43:55.970753-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.709311-08:00","closed_at":"2026-02-01T11:47:38.709311-08:00","close_reason":"PRs submitted"}
{"id":"loc-3vp","title":"Effort Estimation Models","description":"Human and AI effort estimation models for codebase analysis.\n\n## Human Effort (COCOMO-style)\n- Organic development cost estimation\n- Schedule effort calculation\n- Team size estimation\n\n## AI Effort (Token-based)\n- Claude Sonnet/Opus/Haiku cost estimates\n- Input token estimation (context + prompts)\n- Output token estimation (generated code)\n- Wall-clock time estimates for serial/parallel agents\n\n## Interpretation\n- Compare AI vs human cost\n- Expose assumptions transparently\n- Provide actionable insights","status":"closed","priority":1,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:03.659227-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:37.70234-08:00","closed_at":"2026-01-17T12:25:37.70234-08:00","close_reason":"Completed in AI cost model implementation"}
{"id":"loc-3vp.1","title":"Implement COCOMO human effort model","description":"Implement COCOMO-style human effort estimation.\n\n## File: internal/effort/cocomo.go\n\n## COCOMO Basic Organic Model:\n- Effort (PM) = a × (KLOC)^b where a=2.4, b=1.05\n- Time (months) = c × (Effort)^d where c=2.5, d=0.38\n- Team = Effort / Time\n- Cost = Effort × avg_salary_per_month\n\n## Functions:\n- CalculateHumanEffort(loc int, opts COCOMOOptions) HumanEffortEstimate\n\n## HumanEffortEstimate struct:\n- EffortPersonMonths float64\n- ScheduleMonths float64\n- TeamSize float64\n- EstimatedCost float64\n- Model string (\"COCOMO Basic Organic\")","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:38.071792-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.246607-08:00","closed_at":"2026-01-17T12:13:20.246607-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-3vp.1","depends_on_id":"loc-3vp","type":"parent-child","created_at":"2026-01-17T07:40:38.072639-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-3vp.2","title":"Add effort estimates to Report model","description":"Extend Report model with effort estimation fields.\n\n## File: internal/model/report.go\n\n## Add to Report struct:\n- Effort *EffortEstimates `json:\"effort,omitempty\"`\n\n## New types:\ntype EffortEstimates struct {\n    Human    *HumanEffort `json:\"human,omitempty\"`\n    AI       *AIEffort    `json:\"ai,omitempty\"`\n}\n\ntype HumanEffort struct {\n    EstimatedCost    float64  `json:\"estimated_cost\"`\n    ScheduleMonths   float64  `json:\"schedule_months\"`\n    TeamSize         float64  `json:\"team_size\"`\n    Model            string   `json:\"model\"`\n}\n\ntype AIEffort struct {\n    InputTokens      int64    `json:\"input_tokens\"`\n    OutputTokens     int64    `json:\"output_tokens\"`\n    TotalCost        float64  `json:\"total_cost\"`\n    Model            string   `json:\"model\"`\n    Assumptions      []string `json:\"assumptions\"`\n}","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:39.41354-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.248344-08:00","closed_at":"2026-01-17T12:13:20.248344-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-3vp.2","depends_on_id":"loc-3vp","type":"parent-child","created_at":"2026-01-17T07:40:39.414456-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-3vp.3","title":"Integrate effort calculations in aggregator","description":"Add effort calculation to aggregation pipeline.\n\n## File: internal/aggregator/effort.go\n\n## Functions:\n- ComputeEffortEstimates(totalLOC int, opts EffortOptions) *EffortEstimates\n\n## EffortOptions:\n- IncludeHuman bool\n- IncludeAI bool\n- AIModel string (default \"sonnet\")\n- HumanCostPerMonth float64 (default 15000)\n\n## Integration:\n- Call from aggregator.Compute() when opts.IncludeEffort is true\n- Add IncludeEffort to aggregator.Options","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:41.07796-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.253289-08:00","closed_at":"2026-01-17T12:13:20.253289-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-3vp.3","depends_on_id":"loc-3vp","type":"parent-child","created_at":"2026-01-17T07:40:41.078797-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-3vp.3","depends_on_id":"loc-j8f.3","type":"blocks","created_at":"2026-01-17T07:42:02.532533-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-3vp.3","depends_on_id":"loc-3vp.1","type":"blocks","created_at":"2026-01-17T07:42:02.614737-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-3vp.3","depends_on_id":"loc-3vp.2","type":"blocks","created_at":"2026-01-17T07:42:02.693022-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-3vp.4","title":"Add unit tests for effort package","description":"Add comprehensive tests for effort estimation.\n\n## Files:\n- internal/effort/tokens_test.go\n- internal/effort/ai_cost_test.go\n- internal/effort/cocomo_test.go\n\n## Test cases:\n- Token estimation accuracy\n- Cost calculation correctness\n- COCOMO formula verification\n- Edge cases (0 LOC, very large codebases)","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:53.530575-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:32:19.148661-08:00","closed_at":"2026-01-17T12:32:19.148661-08:00","close_reason":"Implemented with parallel agents","dependencies":[{"issue_id":"loc-3vp.4","depends_on_id":"loc-3vp","type":"parent-child","created_at":"2026-01-17T07:41:53.531512-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-4hn","title":"Epic: Aggregation Layer","description":"Compute summaries, ratios, language breakdowns, and trends from classified files.\n\n## Scope\n- internal/aggregator/summary.go - Total counts\n- internal/aggregator/ratios.go - Key ratio calculations\n- internal/aggregator/languages.go - Language x role breakdown\n- internal/aggregator/trends.go - Historical trend computation (future)\n\n## Design References\n- docs/design/json-schema.md (responsibilities, ratios, languages sections)\n- docs/architecture.md (Aggregator section)\n\n## Key Computations\n- Total files, LOC, languages count\n- LOC and file count by role\n- Aggregate confidence per role\n- test_to_prod, infra_to_prod, docs_to_prod ratios\n- Language breakdown with responsibilities per language\n- Test sub-role breakdown (unit/integration/e2e percentages)\n\n## Dependencies\n- Depends on: Epic Foundation (model types)\n\n## Acceptance Criteria\n- [ ] Summary computation is correct\n- [ ] Ratios are pre-calculated (not computed by renderers)\n- [ ] Language breakdown only shows significant roles (\u003e=10%)\n- [ ] Test breakdown percentages sum to 1.0\n- [ ] Confidence aggregation is weighted by LOC\n- [ ] Unit tests with known fixtures","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:31.648425-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.815925-08:00","closed_at":"2026-01-17T12:50:15.815925-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-4hn.1","title":"Implement summary computation in aggregator/summary.go","description":"Compute high-level summary statistics from file records.\n\n## File: internal/aggregator/summary.go\n\n## Interface\n```go\nfunc ComputeSummary(records []*FileRecord) *Summary\n\ntype Summary struct {\n    Files     int\n    LOCTotal  int\n    Languages int\n}\n```\n\n## Implementation\n```go\nfunc ComputeSummary(records []*FileRecord) *Summary {\n    langs := make(map[string]bool)\n    var totalLOC int\n\n    for _, r := range records {\n        totalLOC += r.LOC\n        if r.Language != \"\" \u0026\u0026 r.Language != \"unknown\" {\n            langs[r.Language] = true\n        }\n    }\n\n    return \u0026Summary{\n        Files:     len(records),\n        LOCTotal:  totalLOC,\n        Languages: len(langs),\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] File count correct\n- [ ] LOC total correct\n- [ ] Language count excludes \"unknown\"\n- [ ] Unit tests with known fixtures","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:59:40.414373-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.978484-08:00","closed_at":"2026-01-17T12:25:31.978484-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-4hn.1","depends_on_id":"loc-4hn","type":"parent-child","created_at":"2026-01-17T06:59:40.415411-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-4hn.2","title":"Implement responsibility breakdown in aggregator/responsibilities.go","description":"Compute LOC and file counts grouped by semantic role.\n\n## File: internal/aggregator/responsibilities.go\n\n## Interface\n```go\nfunc ComputeResponsibilities(records []*FileRecord) []Responsibility\n```\n\n## Implementation\n```go\nfunc ComputeResponsibilities(records []*FileRecord) []Responsibility {\n    byRole := make(map[Role]*roleAccum)\n\n    for _, r := range records {\n        acc, ok := byRole[r.Role]\n        if !ok {\n            acc = \u0026roleAccum{Role: r.Role}\n            byRole[r.Role] = acc\n        }\n        acc.LOC += r.LOC\n        acc.Files++\n        acc.ConfidenceSum += float64(r.Confidence) * float64(r.LOC)\n        acc.TotalLOC += r.LOC\n\n        if r.Role == RoleTest \u0026\u0026 r.SubRole != \"\" {\n            acc.SubRoleCounts[r.SubRole] += r.LOC\n        }\n    }\n\n    var result []Responsibility\n    for _, acc := range byRole {\n        resp := Responsibility{\n            Role:       acc.Role,\n            LOC:        acc.LOC,\n            Files:      acc.Files,\n            Confidence: float32(acc.ConfidenceSum / float64(acc.TotalLOC)),\n        }\n\n        // Test breakdown\n        if acc.Role == RoleTest \u0026\u0026 len(acc.SubRoleCounts) \u003e 0 {\n            resp.Breakdown = computeTestBreakdown(acc.SubRoleCounts, acc.LOC)\n        }\n\n        result = append(result, resp)\n    }\n\n    // Sort by LOC descending\n    sort.Slice(result, func(i, j int) bool {\n        return result[i].LOC \u003e result[j].LOC\n    })\n\n    return result\n}\n```\n\n## Test Breakdown\nConvert sub-role LOC counts to percentages:\n```go\nfunc computeTestBreakdown(counts map[TestKind]int, total int) map[TestKind]float32 {\n    breakdown := make(map[TestKind]float32)\n    for kind, loc := range counts {\n        breakdown[kind] = float32(loc) / float32(total)\n    }\n    return breakdown\n}\n```\n\n## Acceptance Criteria\n- [ ] LOC totals by role correct\n- [ ] File counts by role correct\n- [ ] Confidence is LOC-weighted average\n- [ ] Test breakdown percentages sum to ~1.0\n- [ ] Results sorted by LOC descending\n- [ ] Unit tests with known fixtures","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:59:52.354141-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.979878-08:00","closed_at":"2026-01-17T12:25:31.979878-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-4hn.2","depends_on_id":"loc-4hn","type":"parent-child","created_at":"2026-01-17T06:59:52.356544-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-4hn.3","title":"Implement ratio calculations in aggregator/ratios.go","description":"Calculate key ratios (test/prod, infra/prod, etc.) from responsibilities.\n\n## File: internal/aggregator/ratios.go\n\n## Interface\n```go\nfunc ComputeRatios(responsibilities []Responsibility) *Ratios\n```\n\n## Implementation\n```go\nfunc ComputeRatios(responsibilities []Responsibility) *Ratios {\n    byRole := make(map[Role]int)\n    for _, r := range responsibilities {\n        byRole[r.Role] = r.LOC\n    }\n\n    prodLOC := byRole[RoleProd]\n    if prodLOC == 0 {\n        prodLOC = 1  // avoid division by zero\n    }\n\n    return \u0026Ratios{\n        TestToProd:      float32(byRole[RoleTest]) / float32(prodLOC),\n        InfraToProd:     float32(byRole[RoleInfra]) / float32(prodLOC),\n        DocsToProd:      float32(byRole[RoleDocs]) / float32(prodLOC),\n        GeneratedToProd: float32(byRole[RoleGenerated]) / float32(prodLOC),\n        ConfigToProd:    float32(byRole[RoleConfig]) / float32(prodLOC),\n    }\n}\n```\n\n## Design Reference\n- docs/design/json-schema.md (ratios section)\n\n## Acceptance Criteria\n- [ ] All ratios calculated correctly\n- [ ] Division by zero handled\n- [ ] Ratios are pre-calculated (renderers don't compute)\n- [ ] Unit tests with known fixtures","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:00:01.212103-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.981273-08:00","closed_at":"2026-01-17T12:25:31.981273-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-4hn.3","depends_on_id":"loc-4hn","type":"parent-child","created_at":"2026-01-17T07:00:01.214001-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-4hn.4","title":"Implement language breakdown in aggregator/languages.go","description":"Compute language x role breakdown for small multiples display.\n\n## File: internal/aggregator/languages.go\n\n## Interface\n```go\nfunc ComputeLanguageBreakdown(records []*FileRecord) []LanguageComp\n```\n\n## Implementation\n```go\nfunc ComputeLanguageBreakdown(records []*FileRecord) []LanguageComp {\n    byLang := make(map[string]*langAccum)\n\n    for _, r := range records {\n        if r.Language == \"\" || r.Language == \"unknown\" {\n            continue\n        }\n\n        acc, ok := byLang[r.Language]\n        if !ok {\n            acc = \u0026langAccum{\n                Language: r.Language,\n                ByRole:   make(map[Role]int),\n            }\n            byLang[r.Language] = acc\n        }\n\n        acc.LOCTotal += r.LOC\n        acc.Files++\n        acc.ByRole[r.Role] += r.LOC\n    }\n\n    var result []LanguageComp\n    for _, acc := range byLang {\n        // Filter to significant roles (\u003e=10% of language total)\n        significant := make(map[Role]int)\n        for role, loc := range acc.ByRole {\n            if float32(loc)/float32(acc.LOCTotal) \u003e= 0.10 {\n                significant[role] = loc\n            }\n        }\n\n        result = append(result, LanguageComp{\n            Language:         acc.Language,\n            LOCTotal:         acc.LOCTotal,\n            Files:            acc.Files,\n            Responsibilities: significant,\n        })\n    }\n\n    // Sort by total LOC descending\n    sort.Slice(result, func(i, j int) bool {\n        return result[i].LOCTotal \u003e result[j].LOCTotal\n    })\n\n    return result\n}\n```\n\n## Design Reference\n- docs/design/json-schema.md (languages section)\n- docs/design/terminal-wireframe.md (Language Composition section)\n\n## Key Rules\n- Only show significant roles (\u003e=10% of language total)\n- Skip \"unknown\" language\n- Sort by total LOC descending\n\n## Acceptance Criteria\n- [ ] Language totals correct\n- [ ] Role breakdown per language correct\n- [ ] Insignificant roles filtered out\n- [ ] Unknown language excluded\n- [ ] Sorted by LOC descending\n- [ ] Unit tests with known fixtures","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:00:12.48063-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.982657-08:00","closed_at":"2026-01-17T12:25:31.982657-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-4hn.4","depends_on_id":"loc-4hn","type":"parent-child","created_at":"2026-01-17T07:00:12.481963-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-4hn.5","title":"Implement aggregator orchestration in aggregator/aggregator.go","description":"Main aggregator that produces a complete Report from FileRecords.\n\n## File: internal/aggregator/aggregator.go\n\n## Interface\n```go\nfunc Compute(records []*FileRecord, opts ComputeOptions) *Report\n\ntype ComputeOptions struct {\n    IncludeFiles bool     // include file-level details\n    RepoInfo     *RepoInfo\n}\n```\n\n## Implementation\n```go\nfunc Compute(records []*FileRecord, opts ComputeOptions) *Report {\n    responsibilities := ComputeResponsibilities(records)\n\n    report := \u0026Report{\n        Meta: Meta{\n            SchemaVersion:    \"1.0\",\n            GeneratedAt:      time.Now().UTC(),\n            Generator:        \"aloc\",\n            GeneratorVersion: version.Version,\n            Repo:             opts.RepoInfo,\n        },\n        Summary:          ComputeSummary(records),\n        Responsibilities: responsibilities,\n        Ratios:           ComputeRatios(responsibilities),\n        Languages:        ComputeLanguageBreakdown(records),\n        Confidence:       ComputeConfidenceInfo(records),\n    }\n\n    if opts.IncludeFiles {\n        report.Files = records\n    }\n\n    return report\n}\n```\n\n## Acceptance Criteria\n- [ ] All fields populated\n- [ ] Meta includes correct version info\n- [ ] Files included only when requested\n- [ ] Integration test end-to-end","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:00:23.672123-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.98433-08:00","closed_at":"2026-01-17T12:25:31.98433-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-4hn.5","depends_on_id":"loc-4hn","type":"parent-child","created_at":"2026-01-17T07:00:23.673229-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6j7","title":"Epic: TUI Renderer","description":"Tufte-inspired terminal output using lipgloss. Beautiful, screenshot-worthy output that encodes meaning through structure and semantic color.\n\n## Scope\n- internal/renderer/contract.go - Renderer interface\n- internal/renderer/colors.go - Semantic color tokens and theme\n- internal/renderer/tui/renderer.go - Main TUI renderer\n- internal/renderer/tui/bars.go - Bar chart rendering\n- internal/renderer/tui/styles.go - Lipgloss styles\n\n## Design References\n- docs/design/terminal-wireframe.md (complete wireframe spec)\n- docs/design/color-system.md (semantic color tokens)\n\n## Output Sections\n1. Header block (Files, LOC, Languages)\n2. Responsibility ledger with bars\n3. Key ratios with commentary\n4. Language composition (small multiples)\n5. Marginal notes (optional)\n6. Confidence footer\n\n## Critical Rules (from wireframe spec)\n- Numbers are NEVER colored\n- Only labels receive semantic color\n- One semantic color per line maximum\n- Bars are monochrome\n- No background colors\n- No emojis\n- NO_COLOR environment support\n- ASCII fallback mode\n\n## Dependencies\n- Depends on: Epic Foundation (model types)\n- External: github.com/charmbracelet/lipgloss\n\n## Acceptance Criteria\n- [ ] Output matches terminal-wireframe.md exactly\n- [ ] Semantic colors apply only to labels\n- [ ] Numbers are never colored\n- [ ] NO_COLOR mode works\n- [ ] ASCII fallback mode works\n- [ ] 80-100 column width target\n- [ ] Snapshot tests for output stability","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:42.558456-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.817736-08:00","closed_at":"2026-01-17T12:50:15.817736-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-6j7.1","title":"Implement semantic color tokens and theme in renderer/colors.go","description":"Define semantic color tokens and lipgloss-based theme system.\n\n## File: internal/renderer/colors.go\n\n## Semantic Tokens\n```go\ntype SemanticColor string\n\nconst (\n    ColorPrimary      SemanticColor = \"semantic.primary\"\n    ColorSafety       SemanticColor = \"semantic.safety\"\n    ColorOperational  SemanticColor = \"semantic.operational\"\n    ColorKnowledge    SemanticColor = \"semantic.knowledge\"\n    ColorFragility    SemanticColor = \"semantic.fragility\"\n    ColorLowEmphasis  SemanticColor = \"semantic.low_emphasis\"\n    ColorExternal     SemanticColor = \"semantic.external\"\n    ColorWarning      SemanticColor = \"semantic.warning\"\n)\n```\n\n## Role to Token Mapping\n```go\nfunc (r Role) Color() SemanticColor {\n    switch r {\n    case RoleProd:      return ColorPrimary\n    case RoleTest:      return ColorSafety\n    case RoleInfra:     return ColorOperational\n    case RoleDocs:      return ColorKnowledge\n    case RoleConfig:    return ColorFragility\n    case RoleGenerated: return ColorLowEmphasis\n    case RoleVendor:    return ColorExternal\n    case RoleScripts:   return ColorPrimary\n    case RoleExamples:  return ColorKnowledge\n    case RoleDeprecated: return ColorWarning\n    default:            return ColorPrimary\n    }\n}\n```\n\n## Lipgloss Theme\n```go\ntype Theme struct {\n    Primary      lipgloss.Style\n    Safety       lipgloss.Style\n    Operational  lipgloss.Style\n    Knowledge    lipgloss.Style\n    Fragility    lipgloss.Style\n    LowEmphasis  lipgloss.Style\n    External     lipgloss.Style\n    Warning      lipgloss.Style\n}\n\nfunc NewDefaultTheme() *Theme\nfunc NewNoColorTheme() *Theme\nfunc (t *Theme) ForRole(role Role) lipgloss.Style\n```\n\n## Design Reference\n- docs/design/color-system.md (complete spec)\n\n## ANSI Mappings\n| Token | ANSI 256 |\n|-------|----------|\n| primary | default |\n| safety | 37 (dim cyan) |\n| operational | 178 (amber) |\n| knowledge | 245 (gray) |\n| fragility | 67 (gray-blue) |\n| low_emphasis | 240 (dim gray) |\n| external | 240 + italic |\n| warning | 167 (desaturated red) |\n\n## Acceptance Criteria\n- [ ] All tokens defined\n- [ ] Role-\u003etoken mapping complete\n- [ ] Default theme with ANSI colors\n- [ ] NoColor theme (respects NO_COLOR env)\n- [ ] Unit tests for mapping completeness","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:00:38.15119-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.98575-08:00","closed_at":"2026-01-17T12:25:31.98575-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6j7.1","depends_on_id":"loc-6j7","type":"parent-child","created_at":"2026-01-17T07:00:38.171404-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6j7.2","title":"Implement renderer contract interface in renderer/contract.go","description":"Define the Renderer interface that all renderers must implement.\n\n## File: internal/renderer/contract.go\n\n## Interface\n```go\ntype Renderer interface {\n    Render(report *Report) error\n}\n```\n\n## Options Pattern\n```go\ntype RenderOptions struct {\n    Writer     io.Writer  // output destination\n    NoColor    bool       // disable colors\n    Compact    bool       // compact mode for CI\n    Width      int        // terminal width (0 = auto-detect)\n}\n\nfunc DefaultRenderOptions() RenderOptions\n```\n\n## Renderer Contract Rules (from spec)\n1. Numbers are NEVER colored\n2. Only labels receive semantic color\n3. One semantic color per line maximum\n4. Bars are monochrome\n5. No background colors\n6. Color must degrade gracefully to monochrome\n\n## Acceptance Criteria\n- [ ] Interface defined\n- [ ] Options struct with sensible defaults\n- [ ] Contract rules documented in code","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:00:46.857068-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.98736-08:00","closed_at":"2026-01-17T12:25:31.98736-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6j7.2","depends_on_id":"loc-6j7","type":"parent-child","created_at":"2026-01-17T07:00:46.858671-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6j7.3","title":"Implement TUI header and responsibility ledger sections","description":"Render the header block and responsibility breakdown with bars.\n\n## File: internal/renderer/tui/sections.go\n\n## Header Block\n```\nCodebase Summary\n────────────────────────────────────────────────────────────\nFiles: 493          LOC: 126,433          Languages: 7\n```\n\n```go\nfunc (r *TUIRenderer) renderHeader(report *Report) string {\n    // Fixed format: Files -\u003e LOC -\u003e Languages\n    // Numbers formatted with commas\n    // No color in header\n}\n```\n\n## Responsibility Ledger\n```\nResponsibility Breakdown (LOC)\n────────────────────────────────────────────────────────────\nprod        ████████████████████████ 62.1k\ntest        ████████████             29.4k\ninfra       ██████                   14.2k\n```\n\n```go\nfunc (r *TUIRenderer) renderResponsibilities(resp []Responsibility) string {\n    // Left: role label (colored)\n    // Middle: bar (monochrome)\n    // Right: value with k suffix\n\n    maxLOC := findMax(resp)\n    var lines []string\n\n    for _, r := range resp {\n        label := r.theme.ForRole(r.Role).Render(padRight(string(r.Role), 12))\n        bar := renderBar(r.LOC, maxLOC, 24)\n        value := formatLOC(r.LOC)  // 62.1k format\n\n        lines = append(lines, fmt.Sprintf(\"%s %s %s\", label, bar, value))\n    }\n\n    return strings.Join(lines, \"\\n\")\n}\n```\n\n## Design Reference\n- docs/design/terminal-wireframe.md (Header Block, Responsibility Ledger sections)\n\n## Key Rules\n- Role label width: 12 chars\n- Bar max width: 24 chars\n- Value right-aligned with k suffix for thousands\n- Only role label is colored\n\n## Acceptance Criteria\n- [ ] Header matches wireframe exactly\n- [ ] Numbers have comma formatting\n- [ ] Role labels colored correctly\n- [ ] Bars are proportional\n- [ ] Values use k suffix\n- [ ] Snapshot tests for output stability","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:01:00.616704-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.989353-08:00","closed_at":"2026-01-17T12:25:31.989353-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6j7.3","depends_on_id":"loc-6j7","type":"parent-child","created_at":"2026-01-17T07:01:00.617723-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6j7.4","title":"Implement TUI ratios and language composition sections","description":"Render the key ratios block and language composition small multiples.\n\n## Key Ratios Block\n```\nKey Ratios\n────────────────────────────────────────────────────────────\nTest / Prod           0.47    healthy baseline = 0.5-0.8\nInfra / Prod          0.23    operational complexity\nDocs / Prod           0.18    well documented\nGenerated / Prod      0.04    low automation reliance\n```\n\n```go\nfunc (r *TUIRenderer) renderRatios(ratios *Ratios) string {\n    // No colors in ratios section\n    // Values with 2 decimal places\n    // Commentary is plain text\n}\n\nvar ratioCommentary = map[string]string{\n    \"test_to_prod\":      \"healthy baseline = 0.5-0.8\",\n    \"infra_to_prod\":     \"operational complexity\",\n    \"docs_to_prod\":      \"well documented\",\n    \"generated_to_prod\": \"low automation reliance\",\n    \"config_to_prod\":    \"configuration surface\",\n}\n```\n\n## Language Composition\n```\nLanguage Composition\n────────────────────────────────────────────────────────────\nGo        prod ████████████████ 49.2k   test ████████ 18.9k\nMDX       docs ████████████     11.1k\nShell     infra ████████         9.4k\n```\n\n```go\nfunc (r *TUIRenderer) renderLanguages(langs []LanguageComp) string {\n    // Language name: default color\n    // Role label: semantic color\n    // Bar: monochrome\n    // Value: with k suffix\n    // Show max 2 roles per language\n}\n```\n\n## Design Reference\n- docs/design/terminal-wireframe.md (Key Ratios, Language Composition sections)\n\n## Key Rules\n- Ratios have no color\n- Language name is default foreground\n- Role labels colored\n- Only show dominant responsibilities\n- Max 2 roles per language line\n\n## Acceptance Criteria\n- [ ] Ratios formatted correctly\n- [ ] Commentary aligned\n- [ ] Language names default color\n- [ ] Role labels colored\n- [ ] Insignificant roles hidden\n- [ ] Snapshot tests","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:01:13.87535-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.991533-08:00","closed_at":"2026-01-17T12:25:31.991533-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6j7.4","depends_on_id":"loc-6j7","type":"parent-child","created_at":"2026-01-17T07:01:13.87633-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6j7.5","title":"Implement TUI renderer main orchestration and bar rendering","description":"Main TUI renderer that orchestrates sections and implements bar chart rendering.\n\n## File: internal/renderer/tui/renderer.go\n\n## Interface\n```go\ntype TUIRenderer struct {\n    theme   *Theme\n    width   int\n    writer  io.Writer\n    noColor bool\n}\n\nfunc NewTUIRenderer(opts RenderOptions) *TUIRenderer\nfunc (r *TUIRenderer) Render(report *Report) error\n```\n\n## Render Orchestration\n```go\nfunc (r *TUIRenderer) Render(report *Report) error {\n    var sections []string\n\n    sections = append(sections, r.renderHeader(report))\n    sections = append(sections, r.renderResponsibilities(report.Responsibilities))\n    sections = append(sections, r.renderRatios(report.Ratios))\n    sections = append(sections, r.renderLanguages(report.Languages))\n    sections = append(sections, r.renderConfidence(report.Confidence))\n\n    output := strings.Join(sections, \"\\n\\n\")\n    _, err := r.writer.Write([]byte(output + \"\\n\"))\n    return err\n}\n```\n\n## File: internal/renderer/tui/bars.go\n\n## Bar Rendering\n```go\nconst BarChar = \"█\"\nconst BarCharASCII = \"#\"\n\nfunc RenderBar(value, maxValue, maxWidth int) string {\n    if maxValue == 0 {\n        return \"\"\n    }\n    width := (value * maxWidth) / maxValue\n    if width == 0 \u0026\u0026 value \u003e 0 {\n        width = 1  // minimum visible bar\n    }\n    return strings.Repeat(BarChar, width)\n}\n```\n\n## Width Detection\n```go\nfunc detectWidth() int {\n    width, _, err := term.GetSize(int(os.Stdout.Fd()))\n    if err != nil || width == 0 {\n        return 80  // fallback\n    }\n    if width \u003e 100 {\n        return 100  // cap at 100\n    }\n    return width\n}\n```\n\n## NO_COLOR Support\n```go\nfunc shouldDisableColor() bool {\n    _, noColor := os.LookupEnv(\"NO_COLOR\")\n    return noColor\n}\n```\n\n## Design Reference\n- docs/design/terminal-wireframe.md (complete spec)\n\n## Acceptance Criteria\n- [ ] All sections render in correct order\n- [ ] Section separator is blank line\n- [ ] Bar character is █ (Unicode)\n- [ ] ASCII fallback when needed\n- [ ] NO_COLOR respected\n- [ ] Width detection works\n- [ ] Integration test with full report","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:01:27.27183-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.993025-08:00","closed_at":"2026-01-17T12:25:31.993025-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6j7.5","depends_on_id":"loc-6j7","type":"parent-child","created_at":"2026-01-17T07:01:27.272786-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-6kd","title":"Epic: JSON Renderer","description":"Machine-readable JSON output for CI/CD integration and agent consumption.\n\n## Scope\n- internal/renderer/json/renderer.go\n\n## Design References\n- docs/design/json-schema.md (complete schema specification)\n\n## Features\n- Full Report struct serialization\n- Pretty-print option (--pretty)\n- Schema version in output\n- Optional file-level details (--files flag)\n\n## Dependencies\n- Depends on: Epic Foundation (model types)\n\n## Acceptance Criteria\n- [ ] Output validates against JSON schema\n- [ ] Pretty-print mode works\n- [ ] Compact mode (default) works\n- [ ] Schema version included in meta\n- [ ] File list optional and works when enabled","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:49.789165-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.819176-08:00","closed_at":"2026-01-17T12:50:15.819176-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-6kd.1","title":"Implement JSON renderer in renderer/json/renderer.go","description":"JSON renderer for machine-readable output.\n\n## File: internal/renderer/json/renderer.go\n\n## Interface\n```go\ntype JSONRenderer struct {\n    writer io.Writer\n    pretty bool\n}\n\nfunc NewJSONRenderer(opts RenderOptions) *JSONRenderer\nfunc (r *JSONRenderer) Render(report *Report) error\n```\n\n## Implementation\n```go\nfunc (r *JSONRenderer) Render(report *Report) error {\n    enc := json.NewEncoder(r.writer)\n    if r.pretty {\n        enc.SetIndent(\"\", \"  \")\n    }\n    return enc.Encode(report)\n}\n```\n\n## Design Reference\n- docs/design/json-schema.md\n\n## Acceptance Criteria\n- [ ] Outputs valid JSON\n- [ ] Pretty mode works\n- [ ] Compact mode (default) works\n- [ ] Schema version in meta\n- [ ] All fields serialized correctly\n- [ ] Unit test validates against schema","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:01:35.018741-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.994962-08:00","closed_at":"2026-01-17T12:25:31.994962-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-6kd.1","depends_on_id":"loc-6kd","type":"parent-child","created_at":"2026-01-17T07:01:35.019478-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-736","title":"Research ox-cli patterns applicable to aloc","description":"## Purpose\nAnalyze ox-cli codebase for patterns and learnings that can be applied to aloc (excluding complex features like friction).\n\n## Already Analyzed: Theming System ✓\nSee loc-t0c for theming implementation details.\n\nKey patterns from ox-cli theming:\n1. `internal/theme/generated.go` - Auto-generated from design system\n2. `lipgloss.AdaptiveColor` for light/dark terminal detection\n3. Semantic naming (Success, Warning, Error)\n4. Helper functions (`RenderPass()`, `RenderWarn()`)\n5. Icons as constants\n\n## Areas to Research\n\n### CLI UX Patterns\n- [ ] Command structure and help formatting\n- [ ] Progress indicators / spinners\n- [ ] Error message formatting\n- [ ] Interactive prompts\n\n### Architecture Patterns\n- [ ] Internal package organization\n- [ ] Configuration handling\n- [ ] Output formatting abstractions\n\n### Documentation\n- [ ] ADR (Architecture Decision Records) format\n- [ ] AI-readable specs format\n\n## Key Files to Review\n- `cmd/ox/root.go` - CLI structure\n- `internal/cli/` - CLI utilities\n- `docs/ai/specs/` - Design specs\n- `docs/human/adr/` - ADRs\n\n## Exclusions\nDo NOT adopt:\n- Friction system (too complex for aloc's scope)\n- Daemon architecture\n- Auth/OAuth flows\n- Telemetry","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T12:02:50.107417-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:02:50.107417-08:00"}
{"id":"loc-86g","title":"Epic: CLI \u0026 Configuration","description":"Command-line interface using cobra and configuration file support.\n\n## Scope\n- cmd/lloc/main.go - CLI entrypoint\n- pkg/config/config.go - Configuration loading\n- pkg/config/overrides.go - Override file parsing\n\n## Design References\n- docs/architecture.md (CLI Flags section)\n- docs/implementation.md (Phase 5)\n\n## CLI Flags\n- [path] - Target directory (default: .)\n- --format (tui, json, html) - Output format\n- --by (role, language) - Primary grouping\n- --risk - Show risk leaderboard\n- --config - Config file path\n- --no-color - Disable colors\n- --files - Include file-level details in JSON\n\n## Config File (lloc.yaml)\n- overrides: role -\u003e glob patterns\n- exclude: glob patterns\n- options.header_probe: bool\n- options.neighborhood: bool\n\n## Dependencies\n- Depends on: All other epics (integrates everything)\n- External: github.com/spf13/cobra, github.com/spf13/viper\n\n## Acceptance Criteria\n- [ ] All flags work correctly\n- [ ] Config file loading works\n- [ ] Override globs work\n- [ ] Exclude patterns work\n- [ ] Sensible defaults when no config\n- [ ] Help text is clear\n- [ ] Error messages are helpful","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:59.668465-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.820832-08:00","closed_at":"2026-01-17T12:50:15.820832-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-86g.1","title":"Implement CLI root command with cobra in cmd/aloc/main.go","description":"Create the main CLI entrypoint using cobra.\n\n## File: cmd/aloc/main.go\n\n## Command Structure\n```go\nvar rootCmd = \u0026cobra.Command{\n    Use:   \"aloc [path]\",\n    Short: \"Semantic LOC counter - understand your codebase by role\",\n    Long: `aloc analyzes codebases and classifies files by semantic role\n(prod, test, infra, docs, etc.) rather than just language.\n\nOutput includes responsibility breakdown, key ratios, and\nlanguage composition with Tufte-inspired visualization.`,\n    RunE: run,\n}\n\nfunc init() {\n    rootCmd.Flags().StringP(\"format\", \"f\", \"tui\", \"Output format (tui, json, html)\")\n    rootCmd.Flags().String(\"by\", \"role\", \"Primary grouping (role, language)\")\n    rootCmd.Flags().Bool(\"risk\", false, \"Show risk leaderboard\")\n    rootCmd.Flags().StringP(\"config\", \"c\", \"\", \"Config file path\")\n    rootCmd.Flags().Bool(\"no-color\", false, \"Disable colors\")\n    rootCmd.Flags().Bool(\"files\", false, \"Include file-level details in JSON output\")\n    rootCmd.Flags().Bool(\"pretty\", false, \"Pretty-print JSON output\")\n    rootCmd.Flags().Bool(\"header-probe\", false, \"Enable header content probing\")\n}\n\nfunc main() {\n    if err := rootCmd.Execute(); err != nil {\n        os.Exit(1)\n    }\n}\n```\n\n## Run Function\n```go\nfunc run(cmd *cobra.Command, args []string) error {\n    // 1. Determine root path\n    root := \".\"\n    if len(args) \u003e 0 {\n        root = args[0]\n    }\n\n    // 2. Load config\n    // 3. Create scanner\n    // 4. Create inference engine\n    // 5. Scan and infer\n    // 6. Aggregate\n    // 7. Select renderer\n    // 8. Render output\n\n    return nil\n}\n```\n\n## Dependencies\n- github.com/spf13/cobra\n- github.com/spf13/viper (for config)\n\n## Acceptance Criteria\n- [ ] aloc runs without args (current dir)\n- [ ] aloc \u003cpath\u003e scans specified path\n- [ ] --format flag works\n- [ ] --no-color flag works\n- [ ] --config flag works\n- [ ] --files flag works\n- [ ] --help shows usage\n- [ ] Error messages are helpful","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:01:50.082367-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.996765-08:00","closed_at":"2026-01-17T12:25:31.996765-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-86g.1","depends_on_id":"loc-86g","type":"parent-child","created_at":"2026-01-17T07:01:50.083279-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-86g.2","title":"Implement configuration loading in pkg/config/config.go","description":"Load and parse aloc.yaml configuration file.\n\n## File: pkg/config/config.go\n\n## Config Structure\n```go\ntype Config struct {\n    Overrides map[Role][]string `yaml:\"overrides\"`\n    Exclude   []string          `yaml:\"exclude\"`\n    Options   Options           `yaml:\"options\"`\n}\n\ntype Options struct {\n    HeaderProbe    bool `yaml:\"header_probe\"`\n    Neighborhood   bool `yaml:\"neighborhood\"`\n}\n\nfunc DefaultConfig() *Config\nfunc Load(path string) (*Config, error)\nfunc LoadFromDir(dir string) (*Config, error)\n```\n\n## Config File Format (aloc.yaml)\n```yaml\noverrides:\n  prod:\n    - internal/core/**\n    - pkg/domain/**\n  infra:\n    - ops/**\n    - platform/**\n  test:\n    - integration/**\n\nexclude:\n  - vendor/**\n  - node_modules/**\n  - .git/**\n\noptions:\n  header_probe: false\n  neighborhood: true\n```\n\n## Loading Logic\n```go\nfunc LoadFromDir(dir string) (*Config, error) {\n    candidates := []string{\n        filepath.Join(dir, \"aloc.yaml\"),\n        filepath.Join(dir, \"aloc.yml\"),\n        filepath.Join(dir, \".aloc.yaml\"),\n        filepath.Join(dir, \".aloc.yml\"),\n    }\n\n    for _, path := range candidates {\n        if _, err := os.Stat(path); err == nil {\n            return Load(path)\n        }\n    }\n\n    // No config found, use defaults\n    return DefaultConfig(), nil\n}\n```\n\n## Acceptance Criteria\n- [ ] YAML parsing works\n- [ ] All config file locations checked\n- [ ] Sensible defaults when no config\n- [ ] Override globs parsed correctly\n- [ ] Exclude patterns parsed correctly\n- [ ] Options parsed correctly\n- [ ] Error messages for invalid YAML","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:02:03.501605-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.998301-08:00","closed_at":"2026-01-17T12:25:31.998301-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-86g.2","depends_on_id":"loc-86g","type":"parent-child","created_at":"2026-01-17T07:02:03.502587-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-86g.3","title":"Implement full pipeline integration in CLI run function","description":"Wire together scanner, inference, aggregation, and rendering in the CLI.\n\n## Pipeline Flow\n```\nConfig -\u003e Scanner -\u003e Inference -\u003e Aggregation -\u003e Renderer -\u003e Output\n```\n\n## Implementation\n```go\nfunc run(cmd *cobra.Command, args []string) error {\n    ctx := context.Background()\n\n    // 1. Parse flags\n    format, _ := cmd.Flags().GetString(\"format\")\n    noColor, _ := cmd.Flags().GetBool(\"no-color\")\n    includeFiles, _ := cmd.Flags().GetBool(\"files\")\n    pretty, _ := cmd.Flags().GetBool(\"pretty\")\n    configPath, _ := cmd.Flags().GetString(\"config\")\n    headerProbe, _ := cmd.Flags().GetBool(\"header-probe\")\n\n    // 2. Determine root path\n    root := \".\"\n    if len(args) \u003e 0 {\n        root = args[0]\n    }\n    root, err := filepath.Abs(root)\n    if err != nil {\n        return fmt.Errorf(\"invalid path: %w\", err)\n    }\n\n    // 3. Load config\n    var cfg *config.Config\n    if configPath != \"\" {\n        cfg, err = config.Load(configPath)\n    } else {\n        cfg, err = config.LoadFromDir(root)\n    }\n    if err != nil {\n        return fmt.Errorf(\"config error: %w\", err)\n    }\n\n    // 4. Create scanner\n    scanner := scanner.NewScanner(root, scanner.Options{\n        NumWorkers: runtime.NumCPU() * 2,\n        Exclude:    cfg.Exclude,\n    })\n\n    // 5. Scan files\n    rawFiles, errs := scanner.Scan(ctx)\n\n    // 6. Create inference engine\n    engine, err := inference.NewEngine(inference.Options{\n        HeaderProbe:   headerProbe || cfg.Options.HeaderProbe,\n        Neighborhood:  cfg.Options.Neighborhood,\n        OverridesPath: configPath,\n    })\n    if err != nil {\n        return fmt.Errorf(\"inference setup error: %w\", err)\n    }\n\n    // 7. Collect and infer\n    var files []*model.RawFile\n    for f := range rawFiles {\n        files = append(files, f)\n    }\n\n    // Check for scan errors\n    for err := range errs {\n        fmt.Fprintf(os.Stderr, \"warning: %v\\n\", err)\n    }\n\n    records := engine.InferBatch(files)\n\n    // 8. Aggregate\n    report := aggregator.Compute(records, aggregator.Options{\n        IncludeFiles: includeFiles,\n        RepoInfo:     detectRepoInfo(root),\n    })\n\n    // 9. Select renderer\n    renderer := selectRenderer(format, renderer.Options{\n        Writer:  os.Stdout,\n        NoColor: noColor || shouldDisableColor(),\n        Pretty:  pretty,\n    })\n\n    // 10. Render\n    return renderer.Render(report)\n}\n\nfunc selectRenderer(format string, opts renderer.Options) renderer.Renderer {\n    switch format {\n    case \"json\":\n        return json.NewJSONRenderer(opts)\n    case \"html\":\n        return html.NewHTMLRenderer(opts)\n    default:\n        return tui.NewTUIRenderer(opts)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Full pipeline works end-to-end\n- [ ] All flags integrated\n- [ ] Config loaded correctly\n- [ ] Errors handled gracefully\n- [ ] Warnings printed to stderr\n- [ ] Output goes to stdout\n- [ ] Integration test with real repo","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:02:19.250453-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.999926-08:00","closed_at":"2026-01-17T12:25:31.999926-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-86g.3","depends_on_id":"loc-86g","type":"parent-child","created_at":"2026-01-17T07:02:19.25137-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-9qj","title":"Combine binary check with LOC counting (single file open)","description":"## Context\nCurrently every file is opened twice:\n1. `isBinary()` in walker.go - reads 512 bytes\n2. `CountLOC()` in counter.go - full read\n\n## Implementation\n1. Move binary detection into `CountLOC()`\n2. Read first 512 bytes, check for null bytes\n3. If binary, return 0 LOC immediately\n4. If text, continue counting from the buffer\n\n## Code Change\n```go\nfunc CountLOCWithBinaryCheck(path string) (int, bool, error) {\n    f, err := os.Open(path)\n    if err != nil {\n        return 0, false, err\n    }\n    defer f.Close()\n    \n    // Read initial buffer for binary check\n    buf := make([]byte, 512)\n    n, _ := f.Read(buf)\n    \n    // Check for binary\n    for _, b := range buf[:n] {\n        if b == 0 {\n            return 0, true, nil // binary file\n        }\n    }\n    \n    // Continue with LOC counting\n    // ... rest of counting logic\n}\n```\n\n## Expected Impact\nHalves syscall overhead for file opens.","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:02:14.305483-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:26.205194-08:00","closed_at":"2026-01-17T12:49:26.205194-08:00","close_reason":"Implemented: skip directories, extension filtering, single file open, --deep flag. Performance improved from 15s to 0.5s (29x speedup)"}
{"id":"loc-9s6","title":"Performance Critical: 140x slower than scc/tokei","description":"## Problem\naloc is 140x slower than scc (15s vs 0.1s) on the sageox-mono codebase.\n\n## Root Causes Identified\n\n### 1. Missing Directory Skip Patterns (CRITICAL)\nWalker only skips .git, vendor, node_modules but NOT:\n- `.pnpm-store` (75k content-addressable cache files!)\n- `.terraform` (module cache)\n- `.husky` (git hooks)\n\nThis single issue accounts for 93% of files processed (75k of 80k).\n\n### 2. No Pre-filtering by Extension\nFiles without extensions (75k files) are:\n1. Checked for binary (reads 512 bytes)\n2. Read fully to count LOC\n3. Run through inference\nEven though they produce no useful data (classified as 'unknown').\n\n### 3. Double File Opens\nEvery file is opened twice:\n1. `isBinary()` - reads 512 bytes\n2. `CountLOC()` - full read\n\n### 4. No .gitignore Support\nscc/tokei respect .gitignore; aloc doesn't.\n\n## CPU Profile Summary\n```\n62.66% syscall.syscall  (file I/O)\n12.78% runtime.park_m   (goroutine scheduling)\n12.28% bufio.Scanner    (reading files)\n```\n\n## Performance Targets\n- Quick mode: \u003c 1s on sageox-mono (matching scc/tokei)\n- Deep mode: \u003c 5s with header probing and extensionless file analysis","status":"closed","priority":0,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:01:10.860369-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:57.956837-08:00","closed_at":"2026-01-17T12:49:57.956837-08:00","close_reason":"Performance epic complete: 29x speedup achieved (15s → 0.5s). All subtasks implemented: skip directories, extension filtering, single file open, deep flag, gitignore support","dependencies":[{"issue_id":"loc-9s6","depends_on_id":"loc-0fm","type":"blocks","created_at":"2026-01-17T08:07:28.084029-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-9s6","depends_on_id":"loc-d97","type":"blocks","created_at":"2026-01-17T08:07:28.188998-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-9s6","depends_on_id":"loc-9qj","type":"blocks","created_at":"2026-01-17T08:07:28.269491-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-9s6","depends_on_id":"loc-q9g","type":"blocks","created_at":"2026-01-17T08:07:28.347513-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-9s6","depends_on_id":"loc-e1b","type":"blocks","created_at":"2026-01-17T08:07:28.427128-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-9s6","depends_on_id":"loc-v7k","type":"blocks","created_at":"2026-01-17T08:07:28.504497-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-b5a","title":"Epic: Integration Testing \u0026 Quality","description":"End-to-end testing, benchmarks, and quality gates.\n\n## Scope\n- testdata/ fixtures\n- Integration tests\n- Benchmark tests\n- CI pipeline setup\n\n## Test Fixtures\n- testdata/simple-go/ - Basic Go project\n- testdata/monorepo/ - Multi-language project\n- testdata/generated-heavy/ - Generated code detection\n- testdata/expected/ - Golden file outputs\n\n## Quality Gates\n- All tests pass\n- No race conditions (go test -race)\n- Benchmarks meet targets (100k files \u003c 2s)\n- golangci-lint passes\n- Coverage \u003e 80%\n- Output matches wireframe spec\n\n## Dependencies\n- Depends on: All component epics\n\n## Acceptance Criteria\n- [ ] Test fixtures created\n- [ ] Golden file tests pass\n- [ ] Benchmark targets met\n- [ ] Lint passes\n- [ ] Coverage meets threshold","status":"open","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:56:07.818727-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T06:56:07.818727-08:00"}
{"id":"loc-b5a.1","title":"Create test fixtures in testdata/","description":"Create realistic test fixtures for integration testing.\n\n## Directory Structure\n```\ntestdata/\n├── simple-go/              # Basic Go project\n│   ├── main.go\n│   ├── main_test.go\n│   ├── internal/\n│   │   └── auth/\n│   │       ├── login.go\n│   │       └── login_test.go\n│   └── go.mod\n│\n├── monorepo/               # Multi-language project\n│   ├── services/\n│   │   └── api/\n│   │       ├── server.go\n│   │       └── server_test.go\n│   ├── web/\n│   │   ├── index.tsx\n│   │   └── index.spec.tsx\n│   ├── infra/\n│   │   └── terraform/\n│   │       └── main.tf\n│   ├── docs/\n│   │   └── README.md\n│   └── .github/\n│       └── workflows/\n│           └── ci.yaml\n│\n├── generated-heavy/        # Generated code detection\n│   ├── api/\n│   │   ├── api.pb.go       # has \"Code generated by\" header\n│   │   └── api.go\n│   └── gen/\n│       └── models.go       # has \"DO NOT EDIT\" header\n│\n└── expected/               # Golden file outputs\n    ├── simple-go.json\n    ├── simple-go.txt\n    ├── monorepo.json\n    └── monorepo.txt\n```\n\n## File Contents\nEach test file should have realistic code:\n- Go files: ~50-200 lines\n- Test files: test functions with assertions\n- Config files: realistic config structure\n- Generated files: proper headers\n\n## Acceptance Criteria\n- [ ] simple-go fixture created\n- [ ] monorepo fixture created\n- [ ] generated-heavy fixture created\n- [ ] Golden files generated after first run\n- [ ] LOC counts are known and documented","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:02:31.76519-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T07:02:31.76519-08:00","dependencies":[{"issue_id":"loc-b5a.1","depends_on_id":"loc-b5a","type":"parent-child","created_at":"2026-01-17T07:02:31.766211-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-b5a.2","title":"Implement integration tests with golden files","description":"End-to-end tests that verify full pipeline output against golden files.\n\n## File: integration_test.go (root)\n\n## Test Structure\n```go\nfunc TestIntegration_SimpleGo(t *testing.T) {\n    report := runPipeline(t, \"testdata/simple-go\")\n\n    // Verify summary\n    assert.Equal(t, expectedFiles, report.Summary.Files)\n    assert.Equal(t, expectedLOC, report.Summary.LOCTotal)\n\n    // Verify responsibilities\n    prodLOC := findRole(report.Responsibilities, RoleProd)\n    testLOC := findRole(report.Responsibilities, RoleTest)\n    assert.Greater(t, prodLOC.LOC, 0)\n    assert.Greater(t, testLOC.LOC, 0)\n\n    // Verify ratios\n    assert.InDelta(t, expectedTestToProd, report.Ratios.TestToProd, 0.01)\n}\n\nfunc TestIntegration_Monorepo(t *testing.T) {\n    report := runPipeline(t, \"testdata/monorepo\")\n\n    // Should detect multiple languages\n    assert.GreaterOrEqual(t, report.Summary.Languages, 4)\n\n    // Should detect infra\n    infraLOC := findRole(report.Responsibilities, RoleInfra)\n    assert.Greater(t, infraLOC.LOC, 0)\n\n    // Should detect docs\n    docsLOC := findRole(report.Responsibilities, RoleDocs)\n    assert.Greater(t, docsLOC.LOC, 0)\n}\n\nfunc TestIntegration_GeneratedDetection(t *testing.T) {\n    report := runPipeline(t, \"testdata/generated-heavy\")\n\n    genLOC := findRole(report.Responsibilities, RoleGenerated)\n    assert.Greater(t, genLOC.LOC, 0)\n    assert.Greater(t, genLOC.Confidence, 0.85)\n}\n```\n\n## Golden File Tests\n```go\nfunc TestGolden_JSON(t *testing.T) {\n    fixtures := []string{\"simple-go\", \"monorepo\", \"generated-heavy\"}\n\n    for _, fixture := range fixtures {\n        t.Run(fixture, func(t *testing.T) {\n            report := runPipeline(t, \"testdata/\"+fixture)\n            output := renderJSON(report)\n\n            golden := filepath.Join(\"testdata\", \"expected\", fixture+\".json\")\n            if *update {\n                os.WriteFile(golden, []byte(output), 0644)\n            }\n\n            expected, _ := os.ReadFile(golden)\n            assert.JSONEq(t, string(expected), output)\n        })\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Integration tests for all fixtures\n- [ ] Golden file comparison works\n- [ ] -update flag regenerates golden files\n- [ ] Tests run in CI\n- [ ] go test ./... passes","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:02:45.97447-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T07:02:45.97447-08:00","dependencies":[{"issue_id":"loc-b5a.2","depends_on_id":"loc-b5a","type":"parent-child","created_at":"2026-01-17T07:02:45.977162-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-b5a.3","title":"Implement performance benchmarks","description":"Benchmarks to ensure performance targets are met.\n\n## File: benchmark_test.go\n\n## Benchmarks\n```go\nfunc BenchmarkScanner(b *testing.B) {\n    // Create temp dir with many files\n    root := createBenchmarkFixture(b, 10000)\n\n    b.ResetTimer()\n    for i := 0; i \u003c b.N; i++ {\n        scanner := scanner.NewScanner(root, scanner.Options{})\n        files, errs := scanner.Scan(context.Background())\n        drainChannels(files, errs)\n    }\n}\n\nfunc BenchmarkInference(b *testing.B) {\n    files := loadBenchmarkFiles(b)\n    engine := inference.NewEngine(inference.Options{})\n\n    b.ResetTimer()\n    for i := 0; i \u003c b.N; i++ {\n        engine.InferBatch(files)\n    }\n}\n\nfunc BenchmarkFullPipeline(b *testing.B) {\n    root := createBenchmarkFixture(b, 10000)\n\n    b.ResetTimer()\n    for i := 0; i \u003c b.N; i++ {\n        runFullPipeline(root)\n    }\n}\n\nfunc BenchmarkLOCCounter(b *testing.B) {\n    files := findRealFiles(b, 1000)\n\n    b.ResetTimer()\n    for i := 0; i \u003c b.N; i++ {\n        for _, f := range files {\n            scanner.CountLOC(f)\n        }\n    }\n}\n```\n\n## Performance Targets\n- 100k files scanned in \u003c 2 seconds on SSD\n- Inference: \u003c 1ms per file\n- LOC counting: \u003c 100us per file\n\n## Memory Benchmarks\n```go\nfunc BenchmarkMemory(b *testing.B) {\n    root := createBenchmarkFixture(b, 10000)\n\n    b.ReportAllocs()\n    for i := 0; i \u003c b.N; i++ {\n        runFullPipeline(root)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] Scanner benchmark exists\n- [ ] Inference benchmark exists\n- [ ] Full pipeline benchmark exists\n- [ ] Performance targets documented\n- [ ] Benchmarks run in CI (non-blocking)","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:02:57.692321-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T07:02:57.692321-08:00","dependencies":[{"issue_id":"loc-b5a.3","depends_on_id":"loc-b5a","type":"parent-child","created_at":"2026-01-17T07:02:57.694537-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-b5a.4","title":"Setup CI pipeline and linting","description":"Configure GitHub Actions CI and golangci-lint.\n\n## File: .github/workflows/ci.yaml\n\n```yaml\nname: CI\n\non:\n  push:\n    branches: [main]\n  pull_request:\n    branches: [main]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-go@v5\n        with:\n          go-version: '1.22'\n\n      - name: Download dependencies\n        run: go mod download\n\n      - name: Run tests\n        run: go test -race -coverprofile=coverage.out ./...\n\n      - name: Upload coverage\n        uses: codecov/codecov-action@v4\n\n  lint:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-go@v5\n        with:\n          go-version: '1.22'\n\n      - name: Run golangci-lint\n        uses: golangci/golangci-lint-action@v4\n        with:\n          version: latest\n\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - uses: actions/setup-go@v5\n        with:\n          go-version: '1.22'\n\n      - name: Build\n        run: go build ./cmd/aloc\n```\n\n## File: .golangci.yaml\n\n```yaml\nlinters:\n  enable:\n    - errcheck\n    - govet\n    - ineffassign\n    - staticcheck\n    - unused\n    - gofmt\n    - goimports\n\nlinters-settings:\n  errcheck:\n    check-blank: true\n\nissues:\n  exclude-rules:\n    - path: _test\\.go\n      linters:\n        - errcheck\n```\n\n## Acceptance Criteria\n- [ ] CI runs on push and PR\n- [ ] Tests run with race detector\n- [ ] Coverage uploaded\n- [ ] Linting passes\n- [ ] Build succeeds","status":"open","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:03:08.901525-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T07:03:08.901525-08:00","dependencies":[{"issue_id":"loc-b5a.4","depends_on_id":"loc-b5a","type":"parent-child","created_at":"2026-01-17T07:03:08.902428-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-bfg","title":"Documentation \u0026 Licensing","description":"Add MIT license and documentation for AI cost model.\n\n## License\n- Add MIT LICENSE file to repository root\n\n## Documentation\n- Document AI cost model assumptions\n- Add source citations for pricing data\n- Create methodology explanation\n- Update README with new features","status":"open","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:07.214458-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T07:40:07.214458-08:00"}
{"id":"loc-bfg.1","title":"Add MIT LICENSE file","description":"Add MIT license to repository root.\n\n## File: LICENSE\n\n## Content:\nStandard MIT license text with current year and copyright holder.","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:36.642197-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.26882-08:00","closed_at":"2026-01-17T12:13:20.26882-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-bfg.1","depends_on_id":"loc-bfg","type":"parent-child","created_at":"2026-01-17T07:41:36.648288-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-bfg.2","title":"Document AI cost model assumptions","description":"Create documentation for AI cost model methodology.\n\n## File: docs/ai-cost-model.md\n\n## Sections:\n1. Overview - what the model estimates\n2. Token estimation methodology\n3. Pricing constants with citations\n4. Input/output ratio assumptions\n5. Limitations and caveats\n6. Source citations\n\n## Citations to include:\n- Anthropic Claude Pricing: https://www.anthropic.com/claude/sonnet\n- PromptLayer analysis: https://blog.promptlayer.com/claude-ai-pricing-choosing-the-right-model/\n- AI Free API: https://www.aifreeapi.com/en/posts/claude-api-pricing-per-million-tokens","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:38.793001-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:32:19.165765-08:00","closed_at":"2026-01-17T12:32:19.165765-08:00","close_reason":"Implemented with parallel agents","dependencies":[{"issue_id":"loc-bfg.2","depends_on_id":"loc-bfg","type":"parent-child","created_at":"2026-01-17T07:41:38.795496-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-bfg.3","title":"Update README with new features","description":"Update README to document new effort estimation features.\n\n## Additions:\n- Effort estimation section in features\n- CLI flag documentation (--effort, --ai-model)\n- Example output showing effort estimates\n- Link to ai-cost-model.md for methodology","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:40.879076-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:32:19.182064-08:00","closed_at":"2026-01-17T12:32:19.182064-08:00","close_reason":"Implemented with parallel agents","dependencies":[{"issue_id":"loc-bfg.3","depends_on_id":"loc-bfg","type":"parent-child","created_at":"2026-01-17T07:41:40.880015-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-c0a","title":"Submit aloc to jamesmurdza/awesome-ai-devtools","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:43:57.368593-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.73284-08:00","closed_at":"2026-02-01T11:47:38.73284-08:00","close_reason":"PRs submitted"}
{"id":"loc-cta","title":"Define semantic color token system","description":"## Task\nCreate the color token definitions that will be used across all renderers.\n\n## Token Categories\n\n### Responsibility Tokens\n```go\ntype ResponsibilityColor string\nconst (\n    ColorProd      ResponsibilityColor = \"prod\"\n    ColorTest      ResponsibilityColor = \"test\"\n    ColorInfra     ResponsibilityColor = \"infra\"\n    ColorDocs      ResponsibilityColor = \"docs\"\n    ColorConfig    ResponsibilityColor = \"config\"\n    ColorGenerated ResponsibilityColor = \"generated\"\n    ColorScripts   ResponsibilityColor = \"scripts\"\n    ColorExamples  ResponsibilityColor = \"examples\"\n)\n```\n\n### Health Tokens\n```go\ntype HealthColor string\nconst (\n    HealthOk      HealthColor = \"ok\"\n    HealthWarn    HealthColor = \"warn\"\n    HealthBad     HealthColor = \"bad\"\n    HealthNeutral HealthColor = \"neutral\"\n)\n```\n\n### Confidence Styles\n```go\ntype ConfidenceStyle string\nconst (\n    ConfidenceHigh   ConfidenceStyle = \"high\"\n    ConfidenceMedium ConfidenceStyle = \"medium\"\n    ConfidenceLow    ConfidenceStyle = \"low\"\n)\n```\n\n## File Location\n`internal/renderer/tokens.go`","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T12:01:55.177654-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:50.067321-08:00","closed_at":"2026-01-17T12:49:50.067321-08:00","close_reason":"Implemented: colors.go with semantic theming (Primary, Safety, Operational, Knowledge, Fragility, LowEmphasis, External, Warning) + Health indicators (HealthGood, HealthWarning, HealthBad) + Theme.ForRole() method"}
{"id":"loc-cup","title":"Epic: Inference Engine","description":"Heuristic-based semantic classification engine. The heart of lloc - classifying files by role (prod/test/infra/etc) using path, filename, extension, neighborhood, and header signals.\n\n## Scope\n- internal/inference/rules.go - Static rule tables\n- internal/inference/scoring.go - Weight accumulation and resolution\n- internal/inference/engine.go - Orchestration and context\n- internal/inference/overrides.go - User override handling\n\n## Design References\n- docs/design/heuristic-rules.md (complete rule specification)\n- docs/architecture.md (Inference Engine section)\n\n## Key Implementation Details\n- Static rule tables (no regex compilation per file)\n- String prefix/suffix checks over regex\n- Neighborhood inference as second pass\n- Header probes optional and cached\n- Confidence calculation with agreement factor\n- Explainability: every classification includes signals\n\n## Rule Priority Order\n1. User overrides (weight: 1.0)\n2. Header probes (0.60-0.95)\n3. Path fragments (0.55-0.90)\n4. Filename patterns (0.60-0.90)\n5. Neighborhood consensus (0.40)\n6. Extension bias (0.10-0.20)\n\n## Dependencies\n- Depends on: Epic Foundation (model types)\n\n## Acceptance Criteria\n- [ ] All path rules from heuristic-rules.md implemented\n- [ ] All filename rules implemented\n- [ ] Extension bias implemented\n- [ ] Neighborhood inference works correctly\n- [ ] Header probe (optional) works correctly\n- [ ] Confidence calculation matches spec\n- [ ] Every FileRecord includes signals array\n- [ ] User overrides work\n- [ ] Unit tests for each rule class","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:22.2251-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.813768-08:00","closed_at":"2026-01-17T12:50:15.813768-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-cup.1","title":"Define static path rule tables in inference/rules.go","description":"Create the path-based heuristic rule table.\n\n## File: internal/inference/rules.go\n\n## Data Structures\n```go\ntype PathRule struct {\n    Fragment string\n    Role     Role\n    Weight   float32\n}\n\nvar PathRules = []PathRule{\n    // Test paths\n    {\"/test/\", RoleTest, 0.60},\n    {\"/tests/\", RoleTest, 0.60},\n    {\"/__tests__/\", RoleTest, 0.60},\n    {\"/spec/\", RoleTest, 0.55},\n    {\"/unit/\", RoleTest, 0.60},        // test:unit\n    {\"/integration/\", RoleTest, 0.65},  // test:integration\n    {\"/e2e/\", RoleTest, 0.70},          // test:e2e\n\n    // Infra paths\n    {\"/infra/\", RoleInfra, 0.65},\n    {\"/terraform/\", RoleInfra, 0.65},\n    {\"/pulumi/\", RoleInfra, 0.65},\n    {\"/helm/\", RoleInfra, 0.65},\n    {\"/.github/workflows/\", RoleInfra, 0.70},\n    {\"/.gitlab-ci/\", RoleInfra, 0.70},\n    {\"/ci/\", RoleInfra, 0.60},\n    {\"/deploy/\", RoleInfra, 0.65},\n\n    // Docs paths\n    {\"/docs/\", RoleDocs, 0.65},\n    {\"/doc/\", RoleDocs, 0.65},\n    {\"/site/\", RoleDocs, 0.60},\n\n    // Config paths\n    {\"/config/\", RoleConfig, 0.55},\n    {\"/configs/\", RoleConfig, 0.55},\n\n    // Scripts paths\n    {\"/scripts/\", RoleScripts, 0.55},\n    {\"/tools/\", RoleScripts, 0.55},\n    {\"/bin/\", RoleScripts, 0.55},\n    {\"/hack/\", RoleScripts, 0.50},\n\n    // Examples paths\n    {\"/examples/\", RoleExamples, 0.55},\n    {\"/samples/\", RoleExamples, 0.55},\n    {\"/demo/\", RoleExamples, 0.55},\n\n    // Vendor paths (high confidence)\n    {\"/vendor/\", RoleVendor, 0.90},\n    {\"/third_party/\", RoleVendor, 0.90},\n    {\"/node_modules/\", RoleVendor, 0.95},\n\n    // Generated paths\n    {\"/dist/\", RoleGenerated, 0.70},\n    {\"/build/\", RoleGenerated, 0.70},\n    {\"/gen/\", RoleGenerated, 0.80},\n    {\"/generated/\", RoleGenerated, 0.80},\n    {\"/pb/\", RoleGenerated, 0.80},\n}\n```\n\n## Design Reference\n- docs/design/heuristic-rules.md (PathIntent section)\n\n## Acceptance Criteria\n- [ ] All path rules from spec implemented\n- [ ] Weights match spec exactly\n- [ ] Table is static (no initialization at runtime)\n- [ ] Code compiles","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:55.660865-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.966052-08:00","closed_at":"2026-01-17T12:25:31.966052-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.1","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:57:55.661751-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.2","title":"Define static filename and extension rule tables in inference/rules.go","description":"Create the filename pattern and extension bias rule tables.\n\n## File: internal/inference/rules.go (append to existing)\n\n## Filename Rules\n```go\ntype FilenameRule struct {\n    Pattern  string  // suffix, prefix, or contains\n    MatchType string // \"suffix\", \"prefix\", \"contains\"\n    Role     Role\n    SubRole  TestKind  // for test files\n    Weight   float32\n}\n\nvar FilenameRules = []FilenameRule{\n    // Test patterns\n    {\"_test.\", \"contains\", RoleTest, TestUnit, 0.75},\n    {\".spec.\", \"contains\", RoleTest, TestUnit, 0.70},\n    {\".test.\", \"contains\", RoleTest, TestUnit, 0.70},\n    {\"_spec.\", \"contains\", RoleTest, TestUnit, 0.70},\n    {\".e2e.\", \"contains\", RoleTest, TestE2E, 0.80},\n    {\"_e2e.\", \"contains\", RoleTest, TestE2E, 0.80},\n    {\".integration.\", \"contains\", RoleTest, TestIntegration, 0.80},\n    {\"_integration.\", \"contains\", RoleTest, TestIntegration, 0.80},\n    {\"_fixture.\", \"contains\", RoleTest, TestFixture, 0.60},\n    {\"_mock.\", \"contains\", RoleTest, TestFixture, 0.55},\n    {\"_stub.\", \"contains\", RoleTest, TestFixture, 0.55},\n    {\"_fake.\", \"contains\", RoleTest, TestFixture, 0.55},\n\n    // Infra patterns\n    {\"Dockerfile\", \"prefix\", RoleInfra, \"\", 0.85},\n    {\"docker-compose\", \"prefix\", RoleInfra, \"\", 0.80},\n    {\"Makefile\", \"prefix\", RoleInfra, \"\", 0.65},\n    {\"Taskfile\", \"prefix\", RoleInfra, \"\", 0.65},\n    {\"Justfile\", \"prefix\", RoleInfra, \"\", 0.65},\n    {\".tf\", \"suffix\", RoleInfra, \"\", 0.90},\n    {\".tfvars\", \"suffix\", RoleInfra, \"\", 0.90},\n    {\"helmfile\", \"prefix\", RoleInfra, \"\", 0.85},\n    {\".hcl\", \"suffix\", RoleInfra, \"\", 0.80},\n\n    // Config patterns\n    {\".env\", \"prefix\", RoleConfig, \"\", 0.85},\n    {\"config.\", \"prefix\", RoleConfig, \"\", 0.60},\n    {\"settings.\", \"prefix\", RoleConfig, \"\", 0.60},\n    {\".config.\", \"contains\", RoleConfig, \"\", 0.55},\n    {\".conf\", \"suffix\", RoleConfig, \"\", 0.55},\n\n    // Docs patterns\n    {\"README\", \"prefix\", RoleDocs, \"\", 0.80},\n    {\"CHANGELOG\", \"prefix\", RoleDocs, \"\", 0.75},\n    {\"CONTRIBUTING\", \"prefix\", RoleDocs, \"\", 0.75},\n    {\"LICENSE\", \"prefix\", RoleDocs, \"\", 0.70},\n}\n```\n\n## Extension Rules\n```go\ntype ExtensionRule struct {\n    Ext    string\n    Role   Role\n    Weight float32\n}\n\nvar ExtensionRules = []ExtensionRule{\n    // Docs extensions\n    {\".md\", RoleDocs, 0.20},\n    {\".mdx\", RoleDocs, 0.20},\n    {\".rst\", RoleDocs, 0.20},\n    {\".adoc\", RoleDocs, 0.20},\n\n    // Config extensions (weak signal)\n    {\".yaml\", RoleConfig, 0.15},\n    {\".yml\", RoleConfig, 0.15},\n    {\".toml\", RoleConfig, 0.15},\n    {\".json\", RoleConfig, 0.10},\n    {\".ini\", RoleConfig, 0.15},\n\n    // Generated extensions (strong signal)\n    {\".lock\", RoleGenerated, 0.90},\n    {\".sum\", RoleGenerated, 0.85},\n    {\".pb.go\", RoleGenerated, 0.90},\n    {\".pb.ts\", RoleGenerated, 0.90},\n    {\".gen.go\", RoleGenerated, 0.85},\n\n    // Interface/contract\n    {\".proto\", RoleDocs, 0.40},\n}\n```\n\n## Design Reference\n- docs/design/heuristic-rules.md (FilenamePattern, ExtensionBias sections)\n\n## Acceptance Criteria\n- [ ] All filename patterns from spec implemented\n- [ ] All extension rules implemented\n- [ ] Weights match spec exactly\n- [ ] Match types (suffix/prefix/contains) correct\n- [ ] Code compiles","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:58:14.894821-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.969553-08:00","closed_at":"2026-01-17T12:25:31.969553-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.2","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:58:14.896806-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.3","title":"Implement RoleScore accumulation and resolution in inference/scoring.go","description":"Create the scoring engine that accumulates weighted evidence and resolves to a final role.\n\n## File: internal/inference/scoring.go\n\n## Interface\n```go\ntype RoleScore struct {\n    Weights map[Role]float32\n    Signals map[Role][]Signal\n}\n\nfunc NewRoleScore() *RoleScore\nfunc (s *RoleScore) Add(role Role, weight float32, signal Signal)\nfunc (s *RoleScore) AddWithSubRole(role Role, subRole TestKind, weight float32, signal Signal)\nfunc (s *RoleScore) Resolve() (role Role, subRole TestKind, confidence float32, signals []Signal)\n```\n\n## Resolution Algorithm\n```go\nfunc (s *RoleScore) Resolve() (Role, TestKind, float32, []Signal) {\n    // 1. Sort by weight descending\n    ranked := sortByWeight(s.Weights)\n\n    topRole, topWeight := ranked[0].Role, ranked[0].Weight\n    confidence := topWeight\n\n    // 2. Ambiguity penalty\n    if len(ranked) \u003e 1 {\n        secondWeight := ranked[1].Weight\n        if topWeight - secondWeight \u003c 0.15 {\n            confidence *= 0.8  // 20% penalty\n        }\n    }\n\n    // 3. Agreement bonus\n    signals := s.Signals[topRole]\n    agreementFactor := min(1.0, float32(len(signals)) * 0.25)\n    // 1 signal -\u003e 0.25, 2 signals -\u003e 0.50, 3 signals -\u003e 0.75, 4+ -\u003e 1.0\n    confidence = min(confidence * agreementFactor, 1.0)\n\n    // 4. Determine sub-role for test\n    var subRole TestKind\n    if topRole == RoleTest {\n        subRole = s.resolveTestSubRole()\n    }\n\n    return topRole, subRole, confidence, signals\n}\n```\n\n## Tie-Break Order\nIf equal weight:\n1. Override, 2. Vendor, 3. Generated, 4. Test, 5. Infra, 6. Prod, 7. Docs, 8. Config, 9. Scripts, 10. Examples\n\n## Design Reference\n- docs/design/heuristic-rules.md (Conflict Resolution, Confidence Calculation sections)\n\n## Acceptance Criteria\n- [ ] Weights accumulate correctly\n- [ ] Ambiguity penalty applied correctly\n- [ ] Agreement factor calculated correctly\n- [ ] Tie-break order followed\n- [ ] Test sub-role resolved\n- [ ] Unit tests for all scenarios","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:58:40.961185-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.971153-08:00","closed_at":"2026-01-17T12:25:31.971153-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.3","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:58:40.965509-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.4","title":"Implement header probe rules in inference/rules.go","description":"Create header-based detection rules for generated code and other markers.\n\n## File: internal/inference/rules.go (append)\n\n## Header Rules\n```go\ntype HeaderRule struct {\n    Pattern string  // substring to search for\n    Role    Role\n    Weight  float32\n}\n\nvar HeaderRules = []HeaderRule{\n    // Generated code markers\n    {\"Code generated by\", RoleGenerated, 0.95},\n    {\"DO NOT EDIT\", RoleGenerated, 0.90},\n    {\"@generated\", RoleGenerated, 0.90},\n    {\"AUTO-GENERATED\", RoleGenerated, 0.85},\n    {\"This file was automatically generated\", RoleGenerated, 0.90},\n    {\"This file is auto-generated\", RoleGenerated, 0.90},\n\n    // Infra markers\n    {\"terraform {\", RoleInfra, 0.80},\n    {\"provider \\\"\", RoleInfra, 0.75},\n\n    // Test markers (language-specific)\n    {\"describe(\", RoleTest, 0.60},       // JS/TS\n    {\"test(\", RoleTest, 0.60},           // JS/TS\n    {\"func Test\", RoleTest, 0.70},       // Go\n    {\"@Test\", RoleTest, 0.65},           // Java\n    {\"#[test]\", RoleTest, 0.70},         // Rust\n    {\"def test_\", RoleTest, 0.65},       // Python\n\n    // Deprecated markers\n    {\"// Deprecated:\", RoleDeprecated, 0.70},\n    {\"// DEPRECATED\", RoleDeprecated, 0.65},\n    {\"@deprecated\", RoleDeprecated, 0.70},\n}\n```\n\n## Header Probe Function\n```go\nconst MaxHeaderLines = 10\nconst MaxHeaderBytes = 2048\n\nfunc ProbeHeader(path string) ([]byte, error) {\n    f, err := os.Open(path)\n    if err != nil {\n        return nil, err\n    }\n    defer f.Close()\n\n    buf := make([]byte, MaxHeaderBytes)\n    n, _ := f.Read(buf)\n    return buf[:n], nil\n}\n\nfunc ApplyHeaderRules(header []byte, score *RoleScore) {\n    content := string(header)\n    for _, rule := range HeaderRules {\n        if strings.Contains(content, rule.Pattern) {\n            score.Add(rule.Role, rule.Weight, SignalHeader)\n        }\n    }\n}\n```\n\n## Design Reference\n- docs/design/heuristic-rules.md (HeaderProbe section)\n\n## Note\nHeader probe is optional (opt-in). Must be explicitly enabled via config.\n\n## Acceptance Criteria\n- [ ] All header patterns from spec implemented\n- [ ] Reads only first 10 lines / 2KB\n- [ ] Case-sensitive matching\n- [ ] Unit tests for each pattern","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:58:55.216444-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.972561-08:00","closed_at":"2026-01-17T12:25:31.972561-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.4","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:58:55.21752-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.5","title":"Implement neighborhood inference in inference/neighborhood.go","description":"Second-pass inference that uses sibling file classifications to boost confidence for unclassified files.\n\n## File: internal/inference/neighborhood.go\n\n## Interface\n```go\ntype NeighborhoodInferrer struct {\n    threshold float32  // default 0.70 (70% consensus required)\n    minFiles  int      // default 3 (skip dirs with fewer files)\n}\n\nfunc NewNeighborhoodInferrer(opts ...Option) *NeighborhoodInferrer\nfunc (n *NeighborhoodInferrer) Apply(records []*FileRecord) []*FileRecord\n```\n\n## Algorithm\n```\nFor each directory:\n  1. Group files by directory\n  2. Skip if fewer than minFiles\n  3. Count role distribution among files with confidence \u003e= threshold\n  4. If dominant role has \u003e= 70% share:\n     - For each file with confidence \u003c 0.60:\n       - Add +0.40 weight for dominant role\n       - Add SignalNeighborhood to signals\n       - Recalculate confidence\n```\n\n## Example\n```\n/internal/billing/\n  invoice.go        prod  0.90\n  payment.go        prod  0.85\n  discount.go       prod  0.88\n  helpers.go        ???   0.30  \u003c- 3/4 = 75% prod, gets +0.40 prod\n```\n\n## Design Reference\n- docs/design/heuristic-rules.md (DirectoryConsensus section)\n\n## Acceptance Criteria\n- [ ] Neighborhood consensus calculated correctly\n- [ ] Low-confidence files get boosted\n- [ ] Already-confident files unchanged\n- [ ] SignalNeighborhood recorded\n- [ ] Vendor directories skipped\n- [ ] Unit tests for edge cases","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:59:09.231974-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.973888-08:00","closed_at":"2026-01-17T12:25:31.973888-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.5","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:59:09.236328-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.6","title":"Implement inference engine orchestration in inference/engine.go","description":"Main inference engine that orchestrates all heuristics and produces FileRecords.\n\n## File: internal/inference/engine.go\n\n## Interface\n```go\ntype Engine struct {\n    overrides         *Overrides\n    enableHeaderProbe bool\n    enableNeighborhood bool\n    neighborhood      *NeighborhoodInferrer\n}\n\ntype EngineOptions struct {\n    HeaderProbe    bool\n    Neighborhood   bool\n    OverridesPath  string\n}\n\nfunc NewEngine(opts EngineOptions) (*Engine, error)\nfunc (e *Engine) Infer(file *RawFile) *FileRecord\nfunc (e *Engine) InferBatch(files []*RawFile) []*FileRecord\n```\n\n## Inference Pipeline per File\n```go\nfunc (e *Engine) Infer(file *RawFile) *FileRecord {\n    score := NewRoleScore()\n\n    // 1. Check overrides first (weight 1.0)\n    if override := e.overrides.Match(file.Path); override != nil {\n        score.Add(override.Role, 1.0, SignalOverride)\n    }\n\n    // 2. Apply path rules\n    applyPathRules(file.Path, score)\n\n    // 3. Apply filename rules\n    applyFilenameRules(file.Path, score)\n\n    // 4. Apply extension bias (only if not already decisive)\n    if score.MaxWeight() \u003c 0.50 {\n        applyExtensionRules(file.Path, score)\n    }\n\n    // 5. Apply header probe (optional)\n    if e.enableHeaderProbe \u0026\u0026 score.MaxWeight() \u003c 0.80 {\n        header, _ := ProbeHeader(file.Path)\n        applyHeaderRules(header, score)\n    }\n\n    // 6. Resolve\n    role, subRole, confidence, signals := score.Resolve()\n\n    return \u0026FileRecord{\n        Path:       file.Path,\n        LOC:        file.LOC,\n        Language:   file.LanguageHint,\n        Role:       role,\n        SubRole:    subRole,\n        Confidence: confidence,\n        Signals:    signals,\n    }\n}\n```\n\n## Batch Inference with Neighborhood\n```go\nfunc (e *Engine) InferBatch(files []*RawFile) []*FileRecord {\n    // First pass: individual inference\n    records := make([]*FileRecord, len(files))\n    for i, f := range files {\n        records[i] = e.Infer(f)\n    }\n\n    // Second pass: neighborhood inference (if enabled)\n    if e.enableNeighborhood {\n        records = e.neighborhood.Apply(records)\n    }\n\n    return records\n}\n```\n\n## Acceptance Criteria\n- [ ] All rule types applied in correct order\n- [ ] Overrides take precedence\n- [ ] Extension bias only applies when not decisive\n- [ ] Header probe only when enabled and below threshold\n- [ ] Neighborhood inference runs as second pass\n- [ ] FileRecords have all fields populated\n- [ ] Integration test with real file structure","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:59:22.646037-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.975356-08:00","closed_at":"2026-01-17T12:25:31.975356-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.6","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:59:22.64708-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-cup.7","title":"Implement user override parsing in inference/overrides.go","description":"Parse user override configuration and apply to file paths.\n\n## File: internal/inference/overrides.go\n\n## Interface\n```go\ntype Overrides struct {\n    rules []OverrideRule\n}\n\ntype OverrideRule struct {\n    Pattern string\n    Role    Role\n    matcher glob.Glob  // pre-compiled\n}\n\nfunc LoadOverrides(path string) (*Overrides, error)\nfunc (o *Overrides) Match(filePath string) *OverrideResult\n\ntype OverrideResult struct {\n    Role   Role\n    Pattern string  // for explainability\n}\n```\n\n## Config Format (aloc.yaml)\n```yaml\noverrides:\n  prod:\n    - internal/core/**\n    - pkg/domain/**\n  infra:\n    - ops/**\n    - platform/**\n  test:\n    - integration/**\n```\n\n## Implementation\n1. Parse YAML config\n2. Pre-compile glob patterns\n3. On Match(), iterate rules in order\n4. First match wins\n5. Return nil if no match\n\n## Design Reference\n- docs/design/heuristic-rules.md (Overrides section)\n\n## Acceptance Criteria\n- [ ] YAML parsing works\n- [ ] Glob patterns compile correctly\n- [ ] ** wildcard works\n- [ ] First match wins\n- [ ] Returns nil when no match\n- [ ] Errors for invalid patterns","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:59:32.82808-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.977095-08:00","closed_at":"2026-01-17T12:25:31.977095-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-cup.7","depends_on_id":"loc-cup","type":"parent-child","created_at":"2026-01-17T06:59:32.829273-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-d97","title":"Skip extensionless files by default in quick mode","description":"## Context\n75k of 80k files processed have no extension. These are classified as 'unknown' language and provide no value in quick analysis.\n\n## Implementation\n1. In `walker.go`, skip files without extension by default\n2. Add `--deep` flag to include extensionless files\n3. When `--deep` is set, only process extensionless files if:\n   - They pass shebang detection (#!/bin/...)\n   - Or are in a list of known extensionless files (Makefile, Dockerfile, etc.)\n\n## Known Extensionless Files to Always Include\n- Makefile, makefile\n- Dockerfile\n- Jenkinsfile\n- Procfile\n- Vagrantfile\n- LICENSE, LICENCE\n- README (without extension)\n- CHANGELOG\n- CONTRIBUTING\n- AUTHORS\n\n## Expected Impact\nCombined with directory skip, should reduce file count to ~2.6k (matching scc/tokei).","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:02:12.19623-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:26.188612-08:00","closed_at":"2026-01-17T12:49:26.188612-08:00","close_reason":"Implemented: skip directories, extension filtering, single file open, --deep flag. Performance improved from 15s to 0.5s (29x speedup)"}
{"id":"loc-der","title":"Enhanced TUI Output Redesign","description":"Redesign TUI output with new sections for richer analysis.\n\n## New Sections\n1. **Executive Signals** - Summary readable at a glance\n2. **Responsibility Balance** - Percentage-based sparkline bars\n3. **Language × Responsibility Matrix** - Heatmap density view\n4. **Ratios \u0026 Health Signals** - Symbols for meaning interpretation\n5. **Effort Models** - Human \u0026 AI cost/time estimates\n6. **Confidence \u0026 Methodology** - Classification transparency\n\n## Design Principles\n- Tufte-inspired: maximize data-ink ratio\n- Numbers never colored, only labels\n- Symbols help read meaning, not just numbers\n- Progressive disclosure from summary to detail","status":"closed","priority":1,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:05.355053-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:37.680793-08:00","closed_at":"2026-01-17T12:25:37.680793-08:00","close_reason":"Completed in AI cost model implementation"}
{"id":"loc-der.1","title":"Implement Executive Signals section in TUI","description":"Add Executive Signals summary section to TUI output.\n\n## Location: internal/renderer/tui/executive.go\n\n## Content:\n- Total LOC with magnitude formatting (10.22M)\n- Total Files count\n- Languages detected count\n- Responsibility dominance indicator\n- Structural imbalance warnings\n- Classification confidence summary\n\n## Format:\n📦 Total Lines of Code          10.22M\n📁 Total Files                  80,193\n🧠 Languages Detected          18\n📊 Responsibility Dominance    Production code dominant\n\n⚠ Structural Imbalance Detected\n- Test coverage extremely low\n- Documentation surface light","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:11.550102-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.255205-08:00","closed_at":"2026-01-17T12:13:20.255205-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.1","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:11.551336-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.2","title":"Implement percentage-based Responsibility Balance","description":"Redesign responsibility breakdown to show percentages with sparklines.\n\n## Location: internal/renderer/tui/responsibility.go\n\n## Format:\nResponsibility Balance (% of total LOC)\n\nprod        ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓ 97.87%\nconfig      ░░░░░░░  0.67%\ndocs        ░░░░░░░  0.63%\ntest        ░░░░░░   0.35%\n\n## Features:\n- Sparklines encode proportion, not raw width\n- Sorted by percentage descending\n- Use ▓ for filled, ░ for empty","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:13.096949-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.256757-08:00","closed_at":"2026-01-17T12:13:20.256757-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.2","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:13.097696-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.3","title":"Implement Language × Responsibility Matrix","description":"Add heatmap-style language/responsibility matrix.\n\n## Location: internal/renderer/tui/matrix.go\n\n## Format:\nLanguage × Responsibility Density (LOC)\n\n                  prod     test     infra     docs     config\nJavaScript        █████    ░░░░     ░░░░      ░░░░     ░░░░\nTypeScript        ██░░░    ░░░░     ░░░░      ░░░░     ░░░░\nGo                █░░░░    ░░░░     ░░░█      ░░░░     ░░░██\n\nLegend: █ high  ▓ mid  ░ low  · none\n\n## Features:\n- 5-level density encoding\n- Auto-scale based on max value\n- Only show non-zero languages","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:14.501396-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.259277-08:00","closed_at":"2026-01-17T12:13:20.259277-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.3","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:14.502739-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.4","title":"Add health signal symbols to Ratios section","description":"Enhance ratios section with interpretive symbols.\n\n## Location: internal/renderer/tui/ratios.go\n\n## Format:\nTest / Prod Ratio        0.00    ⚠ extremely low (healthy ≈ 0.5–0.8)\nDocs / Prod Ratio        0.01    ⚠ sparse documentation surface\nInfra / Prod Ratio       0.00    ✓ low operation complexity\nGenerated / Prod Ratio   0.00    ✓ minimal automation footprint\nConfig / Prod Ratio      0.01    ◦ manageable config surface\n\n## Symbols:\n- ✓ healthy/good\n- ⚠ warning/low\n- ◦ neutral/acceptable\n- ✗ critical/concerning","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:16.243812-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.261215-08:00","closed_at":"2026-01-17T12:13:20.261215-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.4","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:16.244977-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.5","title":"Implement Effort Models TUI section","description":"Add human and AI effort estimates to TUI output.\n\n## Location: internal/renderer/tui/effort.go\n\n## Format:\nV) Effort Models — Human \u0026 AI cost/time estimates\n\nA) Human effort (COCOMO-style model)\nEstimated Organic Development Cost   $12,383,624\nEstimated Schedule Effort           35.78 months\nEstimated Team Size                 30.74 engineers\n\nB) AI effort (Claude Sonnet)\n  Input Tokens @ $3/MTok    ≈ 40M → ~$120\n  Output Tokens @ $15/MTok  ≈ 10M → ~$150\n  Total AI cost estimate    ≈ $270\n\nInterpretation\n  AI cost is \u003c0.01% of organic human cost\n\n## Features:\n- Format large numbers with commas\n- Show token counts and costs\n- Percentage comparison","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:17.959643-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.263605-08:00","closed_at":"2026-01-17T12:13:20.263605-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.5","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:17.960813-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-der.5","depends_on_id":"loc-3vp.3","type":"blocks","created_at":"2026-01-17T07:42:02.771739-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.6","title":"Add Confidence \u0026 Methodology TUI section","description":"Add methodology transparency section to TUI.\n\n## Location: internal/renderer/tui/confidence.go\n\n## Format:\nVI) Confidence \u0026 Methodology\nClassification Method    heuristic only\nConfidence               low auto, high manual\nToken cost assumptions   exposed, with provider pricing sources\n\n## Features:\n- Show classification breakdown (auto/heuristic/override percentages)\n- List key assumptions made\n- Reference pricing sources","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:20.108992-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.265328-08:00","closed_at":"2026-01-17T12:13:20.265328-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.6","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:20.110125-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-der.7","title":"Add TUI renderer integration for effort","description":"Integrate effort sections into main TUI renderer.\n\n## File: internal/renderer/tui/renderer.go\n\n## Changes:\n- Import new section renderers\n- Add effort section rendering when report.Effort is non-nil\n- Update section ordering for new layout\n- Ensure proper spacing between sections","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:55.420113-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.267148-08:00","closed_at":"2026-01-17T12:13:20.267148-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-der.7","depends_on_id":"loc-der","type":"parent-child","created_at":"2026-01-17T07:41:55.422465-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-der.7","depends_on_id":"loc-der.1","type":"blocks","created_at":"2026-01-17T07:42:02.850414-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-der.7","depends_on_id":"loc-der.5","type":"blocks","created_at":"2026-01-17T07:42:02.931023-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-e1b","title":"Implement .gitignore support","description":"## Context\nscc and tokei respect .gitignore, aloc doesn't. This filters out:\n- Build artifacts\n- Log files\n- IDE settings\n- Other ignored files\n\n## Implementation Options\n\n### Option A: Use go-gitignore library\n```go\nimport \"github.com/sabhiram/go-gitignore\"\n\nfunc NewWalker(...) {\n    gi, _ := gitignore.CompileIgnoreFile(filepath.Join(root, \".gitignore\"))\n    // Use gi.MatchesPath() in Walk()\n}\n```\n\n### Option B: Shell out to git\n```go\n// Use 'git ls-files' to get tracked files only\n```\n\n### Option C: Custom implementation\nParse .gitignore manually (not recommended - complex edge cases)\n\n## Recommendation\nUse go-gitignore library - well-tested, handles edge cases\n\n## Config Support\n```yaml\noptions:\n  respect_gitignore: true  # default true\n```","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:04:13.682125-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:48.309534-08:00","closed_at":"2026-01-17T12:49:48.309534-08:00","close_reason":"Implemented: gitignore.go with pattern parsing, negation, directory-only, and anchored pattern support"}
{"id":"loc-iid","title":"Submit aloc to agarrharr/awesome-cli-apps","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:43:59.005203-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.755466-08:00","closed_at":"2026-02-01T11:47:38.755466-08:00","close_reason":"PRs submitted"}
{"id":"loc-irp","title":"Apply health colors to ratio display","description":"## Task\nColor the key ratios based on health thresholds.\n\n## Current Display\n```\nTest / Prod         0.00    healthy baseline ≈ 0.5–0.8\n```\n\n## Target Display\n```\nTest / Prod         0.00    ⚠ extremely low     (amber)\nTest / Prod         0.65    ✓ healthy           (green)\nTest / Prod         1.50    ⚠ unusually high    (amber)\n```\n\n## Health Thresholds\n| Ratio | Low (warn) | Healthy | High (warn) |\n|-------|-----------|---------|-------------|\n| Test/Prod | \u003c 0.3 | 0.3-1.0 | \u003e 1.5 |\n| Docs/Prod | \u003c 0.01 | 0.01-0.1 | \u003e 0.2 |\n| Infra/Prod | n/a | \u003c 0.1 | \u003e 0.2 |\n| Generated/Prod | n/a | \u003c 0.2 | \u003e 0.5 |\n\n## Implementation\nNumbers stay neutral. Interpretation (emoji + label) gets color.","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T12:01:58.413731-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:32:37.963359-08:00","closed_at":"2026-01-17T12:32:37.963359-08:00","close_reason":"Implemented - health colors in health_ratios.go, extension filtering in walker.go"}
{"id":"loc-itx","title":"Submit aloc to linsa-io/command-line-tools","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:44:01.402591-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.795174-08:00","closed_at":"2026-02-01T11:47:38.795174-08:00","close_reason":"PRs submitted"}
{"id":"loc-j8f","title":"AI Cost Model Infrastructure","description":"Core infrastructure for AI cost estimation based on token pricing.\n\n## Goals\n- Define pricing constants for Claude models (Sonnet, Opus, Haiku)\n- Implement token estimation from LOC\n- Support configurable input/output token ratios\n- Expose pricing assumptions to users\n\n## Sources\n- Anthropic Claude Pricing: https://www.anthropic.com/claude/sonnet\n- PromptLayer analysis: https://blog.promptlayer.com/claude-ai-pricing-choosing-the-right-model/\n- AI Free API pricing: https://www.aifreeapi.com/en/posts/claude-api-pricing-per-million-tokens\n\n## Key Constants (Claude Sonnet)\n- Input tokens: $3.00 / million\n- Output tokens: $15.00 / million\n- Token efficiency: ~1 output token per LOC\n- Input/output ratio: ~4:1","status":"closed","priority":1,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:01.704835-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:37.718089-08:00","closed_at":"2026-01-17T12:25:37.718089-08:00","close_reason":"Completed in AI cost model implementation"}
{"id":"loc-j8f.1","title":"Define AI pricing constants in model/pricing.go","description":"Create pricing constants for Claude models.\n\n## File: internal/model/pricing.go\n\n## Constants needed:\n- ClaudeSonnetInputCost = 3.00 (per million tokens)\n- ClaudeSonnetOutputCost = 15.00 (per million tokens)\n- ClaudeOpusInputCost = 15.00\n- ClaudeOpusOutputCost = 75.00\n- ClaudeHaikuInputCost = 0.25\n- ClaudeHaikuOutputCost = 1.25\n\n## Types:\n- ModelPricing struct with InputCostPerMillion, OutputCostPerMillion\n- PricingSource struct for citation tracking\n\n## Sources to cite:\n- https://www.anthropic.com/claude/sonnet","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:33.116463-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.233042-08:00","closed_at":"2026-01-17T12:13:20.233042-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-j8f.1","depends_on_id":"loc-j8f","type":"parent-child","created_at":"2026-01-17T07:40:33.118567-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-j8f.2","title":"Implement token estimation from LOC","description":"Estimate token counts from LOC metrics.\n\n## File: internal/effort/tokens.go\n\n## Functions:\n- EstimateOutputTokens(loc int) int64 - ~1 token per LOC\n- EstimateInputTokens(outputTokens int64, ratio float64) int64 - default 4:1\n- EstimateTotalTokens(loc int, inputRatio float64) TokenEstimate\n\n## TokenEstimate struct:\n- InputTokens int64\n- OutputTokens int64\n- TotalTokens int64\n- Assumptions []string (transparency)","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:34.760699-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.241531-08:00","closed_at":"2026-01-17T12:13:20.241531-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-j8f.2","depends_on_id":"loc-j8f","type":"parent-child","created_at":"2026-01-17T07:40:34.761482-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-j8f.2","depends_on_id":"loc-j8f.1","type":"blocks","created_at":"2026-01-17T07:42:02.357689-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-j8f.3","title":"Implement AI cost calculator","description":"Calculate AI costs from token estimates.\n\n## File: internal/effort/ai_cost.go\n\n## Functions:\n- CalculateAICost(tokens TokenEstimate, pricing ModelPricing) AICostEstimate\n- FormatCost(cents int64) string - human readable ($X.XX)\n\n## AICostEstimate struct:\n- InputCost float64\n- OutputCost float64\n- TotalCost float64\n- Model string\n- Assumptions []string","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:40:36.517551-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.243803-08:00","closed_at":"2026-01-17T12:13:20.243803-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-j8f.3","depends_on_id":"loc-j8f","type":"parent-child","created_at":"2026-01-17T07:40:36.518538-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-j8f.3","depends_on_id":"loc-j8f.2","type":"blocks","created_at":"2026-01-17T07:42:02.444834-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-j8f.4","title":"Add --effort and --ai-model CLI flags","description":"Add CLI flags for effort estimation.\n\n## File: cmd/aloc/main.go\n\n## New flags:\n- --effort: Enable effort estimation in output (default: false)\n- --ai-model: AI model for cost estimation (sonnet|opus|haiku, default: sonnet)\n- --human-cost: Monthly cost per engineer for COCOMO (default: 15000)\n\n## Integration:\n- Pass flags to aggregator.Options\n- Only compute effort when --effort flag is set","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T07:41:42.490859-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:13:20.245222-08:00","closed_at":"2026-01-17T12:13:20.245222-08:00","close_reason":"Implemented as part of AI cost model feature","dependencies":[{"issue_id":"loc-j8f.4","depends_on_id":"loc-j8f","type":"parent-child","created_at":"2026-01-17T07:41:42.495523-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-n5v","title":"Parse embedded code blocks in Markdown files (tokei-style)","status":"closed","priority":2,"issue_type":"feature","owner":"rsnodgrass@gmail.com","created_at":"2026-01-18T23:35:21.744731-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-18T23:43:42.948896-08:00","closed_at":"2026-01-18T23:43:42.948896-08:00","close_reason":"Implemented Markdown embedded code parsing with tree display"}
{"id":"loc-ok1","title":"Detect embedded code blocks in Markdown (like tokei)","description":"Like tokei, detect and separately count fenced code blocks embedded within Markdown files. When Markdown contains \\`\\`\\`go or \\`\\`\\`bash blocks, count those lines under their respective languages and show nested breakdown like tokei does. This provides more accurate language distribution for documentation-heavy repos.","status":"open","priority":3,"issue_type":"feature","owner":"rsnodgrass@gmail.com","created_at":"2026-01-18T19:15:14.241313-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-18T19:15:28.836633-08:00"}
{"id":"loc-pg1","title":"Semantic Color System: Color by meaning, not language","description":"## North Star\nColors encode meaning, not syntax. Languages inherit color from their architectural role. Health overlays color interpretation, not raw data.\n\n## Problem with Language Colors\n- Too many languages\n- No stable mental model\n- Encourages trivia, not insight\n- Becomes unusable in large repos\n\n## The Right Semantic Axes\n\n### Axis A - Responsibility/Intent (primary)\nWhy does this code exist?\n\n### Axis B - Signal/Health (secondary)\nIs this good, neutral, or concerning?\n\n### Axis C - Confidence/Certainty (tertiary)\nHow much should I trust this classification?\n\n## Proposed Token System\n\n### Responsibility Colors (stable, meaningful)\n| Responsibility | Token | Color | Rationale |\n|---------------|-------|-------|-----------|\n| Production | `--aloc-prod` | Neutral/white | 'This is the system' |\n| Test | `--aloc-test` | Cool green | Safety, validation |\n| Infra | `--aloc-infra` | Amber/yellow | Caution, ops |\n| Docs | `--aloc-docs` | Soft blue | Knowledge, calm |\n| Config | `--aloc-config` | Cyan/teal | Structure, wiring |\n| Generated | `--aloc-generated` | Dim gray | Low agency |\n| Scripts | `--aloc-scripts` | Purple (dim) | Glue, ad-hoc |\n| Examples | `--aloc-examples` | Faint italic | Non-critical |\n\n### Health/Signal Colors (orthogonal overlay)\n| State | Token | Color | Usage |\n|-------|-------|-------|-------|\n| Healthy | `--aloc-ok` | Muted green | Balanced ratios |\n| Caution | `--aloc-warn` | Amber | Mild imbalance |\n| Problem | `--aloc-bad` | Soft red | Structural smells |\n| Neutral | `--aloc-neutral` | Default fg | Informational |\n\n### Confidence (style, not hue)\n| Confidence | Representation |\n|------------|----------------|\n| High | Normal weight |\n| Medium | Dim |\n| Low | Italic/dotted glyphs |\n\n## Implementation Approach\nEach renderer (TTY, JSON, HTML, TUI) maps tokens independently.\nAnalyze ox-cli for theming patterns to adopt.","status":"closed","priority":1,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T12:01:34.604069-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:32:39.677991-08:00","closed_at":"2026-01-17T12:32:39.677991-08:00","close_reason":"Implemented with parallel agents","dependencies":[{"issue_id":"loc-pg1","depends_on_id":"loc-cta","type":"blocks","created_at":"2026-01-17T12:02:07.175492-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-pg1","depends_on_id":"loc-t0c","type":"blocks","created_at":"2026-01-17T12:02:07.274255-08:00","created_by":"Ryan Snodgrass"},{"issue_id":"loc-pg1","depends_on_id":"loc-irp","type":"blocks","created_at":"2026-01-17T12:02:07.370685-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-q9g","title":"Add --deep flag for expensive analysis operations","description":"## Context\nSome analysis operations are expensive and should be opt-in:\n- Header probing (reads file content)\n- Extensionless file analysis\n- Neighborhood inference\n- Future: content-based language detection\n\n## Implementation\n1. Add `--deep` flag to CLI (`cmd/aloc/main.go`)\n2. In quick mode (default):\n   - Skip extensionless files (except known ones)\n   - Disable header probing\n   - Disable neighborhood inference\n3. In deep mode:\n   - Enable all analysis features\n   - Process extensionless files with shebang detection\n   - Enable header probing\n   - Enable neighborhood inference\n\n## CLI Changes\n```\naloc [path]              # Quick mode (fast)\naloc --deep [path]       # Deep mode (thorough)\n```\n\n## Config Support\n```yaml\n# aloc.yaml\noptions:\n  deep: true  # Always use deep mode for this project\n```","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:03:38.888185-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:26.222477-08:00","closed_at":"2026-01-17T12:49:26.222477-08:00","close_reason":"Implemented: skip directories, extension filtering, single file open, --deep flag. Performance improved from 15s to 0.5s (29x speedup)"}
{"id":"loc-t0c","title":"Implement TUI theme with semantic colors","description":"## Task\nUpdate `internal/renderer/tui/renderer.go` to use semantic color tokens following ox-cli patterns.\n\n## ox-cli Theming Patterns to Adopt\n\n### 1. Generated Token File\nCreate `internal/renderer/theme/generated.go`:\n```go\npackage theme\n\nimport (\n    lipgloss \"charm.land/lipgloss/v2\"\n    \"charm.land/lipgloss/v2/compat\"\n)\n\n// Responsibility colors - adaptive for light/dark terminals\nvar (\n    ColorProd = compat.AdaptiveColor{\n        Light: lipgloss.Color(\"#2E2E2E\"),\n        Dark:  lipgloss.Color(\"#E8E8E8\"),\n    }\n    ColorTest = compat.AdaptiveColor{\n        Light: lipgloss.Color(\"#4F6A48\"),\n        Dark:  lipgloss.Color(\"#7A8F78\"),\n    }\n    ColorInfra = compat.AdaptiveColor{\n        Light: lipgloss.Color(\"#B87D3A\"),\n        Dark:  lipgloss.Color(\"#E0A56A\"),\n    }\n    // ... etc\n)\n```\n\n### 2. Semantic Styles File\nCreate `internal/renderer/styles.go`:\n```go\npackage renderer\n\nvar (\n    StyleProd = lipgloss.NewStyle().Foreground(theme.ColorProd)\n    StyleTest = lipgloss.NewStyle().Foreground(theme.ColorTest)\n    // ... etc\n)\n\nfunc RenderRole(s string, role model.Role) string {\n    switch role {\n    case model.RoleProd:\n        return StyleProd.Render(s)\n    // ...\n    }\n}\n```\n\n### 3. Icons Constants\n```go\nconst (\n    IconHealthy = \"✓\"\n    IconWarning = \"⚠\"\n    IconProblem = \"✖\"\n)\n```\n\n## File Changes\n1. Create `internal/renderer/theme/generated.go`\n2. Update `internal/renderer/colors.go` → `internal/renderer/styles.go`\n3. Update `internal/renderer/tui/renderer.go` to use new styles","status":"closed","priority":1,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T12:01:56.924563-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:50.083274-08:00","closed_at":"2026-01-17T12:49:50.083274-08:00","close_reason":"Implemented: colors.go with semantic theming (Primary, Safety, Operational, Knowledge, Fragility, LowEmphasis, External, Warning) + Health indicators (HealthGood, HealthWarning, HealthBad) + Theme.ForRole() method","dependencies":[{"issue_id":"loc-t0c","depends_on_id":"loc-cta","type":"blocks","created_at":"2026-01-17T12:02:07.458796-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-ts8","title":"Submit aloc to Kikobeats/awesome-cli","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-02-01T11:44:00.129746-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-02-01T11:47:38.777653-08:00","closed_at":"2026-02-01T11:47:38.777653-08:00","close_reason":"PRs submitted"}
{"id":"loc-u9u","title":"Epic: Scanner Layer","description":"Parallel filesystem traversal, LOC counting, and language detection. Must handle large repos (100k+ files) efficiently.\n\n## Scope\n- internal/scanner/walker.go - Parallel filesystem traversal\n- internal/scanner/counter.go - LOC counting\n- internal/scanner/language.go - Language detection\n- .gitignore respect\n- Binary file detection and skipping\n\n## Design References\n- docs/architecture.md (Scanner section)\n- docs/implementation.md (Phase 1.3)\n\n## Performance Targets\n- 100k files in \u003c 2 seconds on SSD\n- Worker pool sized for SSD throughput (~16-32 workers)\n- Buffer pool for file reads\n- No per-line allocations in hot paths\n\n## Dependencies\n- Depends on: Epic Foundation (model types)\n- External: github.com/monochromegane/go-gitignore\n\n## Acceptance Criteria\n- [ ] Walker respects .gitignore\n- [ ] Binary files are skipped\n- [ ] LOC counts match tokei on test fixtures\n- [ ] Language detection covers Go, TS, Python, Rust, Java, Shell, YAML\n- [ ] Benchmarks meet performance targets","status":"closed","priority":2,"issue_type":"epic","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:55:09.590905-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:50:15.811058-08:00","closed_at":"2026-01-17T12:50:15.811058-08:00","close_reason":"Bootstrap epics - already implemented in codebase"}
{"id":"loc-u9u.1","title":"Implement parallel filesystem walker in scanner/walker.go","description":"Create a fast, parallel filesystem walker that respects .gitignore.\n\n## File: internal/scanner/walker.go\n\n## Interface\n```go\ntype Walker struct {\n    root       string\n    numWorkers int\n    ignorer    gitignore.IgnoreMatcher\n}\n\ntype WalkOptions struct {\n    NumWorkers int\n    Exclude    []string\n}\n\nfunc NewWalker(root string, opts WalkOptions) (*Walker, error)\nfunc (w *Walker) Walk(ctx context.Context) (\u003c-chan string, \u003c-chan error)\n```\n\n## Implementation Details\n1. Use filepath.WalkDir for traversal\n2. Load .gitignore at each directory level\n3. Skip .git directories\n4. Skip binary files (detect via magic bytes)\n5. Worker pool receives paths, does not read content yet\n6. Respect ctx cancellation\n\n## Dependencies\n- github.com/monochromegane/go-gitignore (or similar)\n\n## Performance Requirements\n- Non-blocking channel sends\n- Worker pool sized for SSD throughput (default: runtime.NumCPU() * 2)\n- Pre-allocate path buffers\n\n## Acceptance Criteria\n- [ ] Walks directories recursively\n- [ ] Respects .gitignore files\n- [ ] Skips .git directory\n- [ ] Detects and skips binary files\n- [ ] Context cancellation works\n- [ ] No goroutine leaks","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:10.737609-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.95747-08:00","closed_at":"2026-01-17T12:25:31.95747-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-u9u.1","depends_on_id":"loc-u9u","type":"parent-child","created_at":"2026-01-17T06:57:10.738488-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-u9u.2","title":"Implement LOC counter in scanner/counter.go","description":"Count lines of code, excluding blanks and comments.\n\n## File: internal/scanner/counter.go\n\n## Interface\n```go\nfunc CountLOC(path string) (int, error)\nfunc CountLOCFromReader(r io.Reader, lang string) (int, error)\n```\n\n## Implementation Details\n1. Use sync.Pool for buffer reuse\n2. Read file in chunks (64KB buffers)\n3. Count non-blank lines\n4. Language-aware comment detection:\n   - // and /* */ for C-style languages\n   - # for shell, Python, YAML\n   - -- for SQL\n   - ; for Lisp-family\n5. Handle multi-line strings (don't count as comments)\n\n## Comment Detection by Language\n| Language | Line comment | Block comment |\n|----------|--------------|---------------|\n| Go, TS, JS, Java, C, Rust | // | /* */ |\n| Python, Shell, YAML | # | (none) |\n| SQL | -- | /* */ |\n| HTML | (none) | \u003c!-- --\u003e |\n\n## Performance Requirements\n- Buffer reuse via sync.Pool\n- No per-line allocations\n- Single-pass counting\n\n## Acceptance Criteria\n- [ ] Counts match tokei on test fixtures\n- [ ] Comments are excluded\n- [ ] Blank lines are excluded\n- [ ] Buffer pooling implemented\n- [ ] Benchmarks show no allocations per line","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:21.329821-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.960955-08:00","closed_at":"2026-01-17T12:25:31.960955-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-u9u.2","depends_on_id":"loc-u9u","type":"parent-child","created_at":"2026-01-17T06:57:21.330769-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-u9u.3","title":"Implement language detection in scanner/language.go","description":"Detect programming language from file extension and shebang.\n\n## File: internal/scanner/language.go\n\n## Interface\n```go\nfunc DetectLanguage(path string, header []byte) string\n```\n\n## Implementation Details\n\n### Extension Mapping (primary signal)\n```go\nvar extToLang = map[string]string{\n    \".go\":    \"Go\",\n    \".ts\":    \"TypeScript\",\n    \".tsx\":   \"TypeScript\",\n    \".js\":    \"JavaScript\",\n    \".jsx\":   \"JavaScript\",\n    \".py\":    \"Python\",\n    \".rs\":    \"Rust\",\n    \".java\":  \"Java\",\n    \".kt\":    \"Kotlin\",\n    \".swift\": \"Swift\",\n    \".rb\":    \"Ruby\",\n    \".c\":     \"C\",\n    \".cpp\":   \"C++\",\n    \".h\":     \"C\",\n    \".hpp\":   \"C++\",\n    \".cs\":    \"C#\",\n    \".sh\":    \"Shell\",\n    \".bash\":  \"Shell\",\n    \".zsh\":   \"Shell\",\n    \".yaml\":  \"YAML\",\n    \".yml\":   \"YAML\",\n    \".json\":  \"JSON\",\n    \".toml\":  \"TOML\",\n    \".md\":    \"Markdown\",\n    \".mdx\":   \"MDX\",\n    \".sql\":   \"SQL\",\n    \".tf\":    \"Terraform\",\n    \".proto\": \"Protocol Buffers\",\n    \".html\":  \"HTML\",\n    \".css\":   \"CSS\",\n    \".scss\":  \"SCSS\",\n    \".less\":  \"LESS\",\n}\n```\n\n### Shebang Detection (secondary signal)\nFor files without extension:\n- #!/bin/bash, #!/usr/bin/env bash -\u003e Shell\n- #!/usr/bin/env python -\u003e Python\n- #!/usr/bin/env node -\u003e JavaScript\n\n### Fallback\n- No match -\u003e \"unknown\"\n\n## Acceptance Criteria\n- [ ] All common languages detected\n- [ ] Shebang parsing works\n- [ ] Case-insensitive extension matching\n- [ ] Returns \"unknown\" for unrecognized\n- [ ] No panics on edge cases","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:32.293594-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.96264-08:00","closed_at":"2026-01-17T12:25:31.96264-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-u9u.3","depends_on_id":"loc-u9u","type":"parent-child","created_at":"2026-01-17T06:57:32.294804-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-u9u.4","title":"Implement scanner orchestration and RawFile emission","description":"Combine walker, counter, and language detection into a unified scanner that emits RawFile records.\n\n## File: internal/scanner/scanner.go\n\n## Interface\n```go\ntype Scanner struct {\n    walker  *Walker\n    pool    *sync.Pool  // buffer pool\n}\n\ntype ScanOptions struct {\n    NumWorkers int\n    Exclude    []string\n}\n\nfunc NewScanner(root string, opts ScanOptions) (*Scanner, error)\nfunc (s *Scanner) Scan(ctx context.Context) (\u003c-chan *RawFile, \u003c-chan error)\n```\n\n## Implementation Details\n1. Walker emits file paths\n2. Worker pool processes each path:\n   - Read first N bytes for language detection\n   - Count LOC\n   - Emit RawFile\n3. Aggregate errors in error channel\n4. Clean shutdown on context cancellation\n\n## RawFile Population\n```go\nRawFile{\n    Path:         path,\n    Bytes:        fileInfo.Size(),\n    LOC:          CountLOC(path),\n    LanguageHint: DetectLanguage(path, header),\n}\n```\n\n## Acceptance Criteria\n- [ ] Scans directories and emits RawFile\n- [ ] Worker pool respects NumWorkers\n- [ ] Errors collected in error channel\n- [ ] Context cancellation works\n- [ ] No goroutine leaks\n- [ ] Performance benchmark passes","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T06:57:41.693976-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:25:31.964653-08:00","closed_at":"2026-01-17T12:25:31.964653-08:00","close_reason":"Already implemented","dependencies":[{"issue_id":"loc-u9u.4","depends_on_id":"loc-u9u","type":"parent-child","created_at":"2026-01-17T06:57:41.694891-08:00","created_by":"Ryan Snodgrass"}]}
{"id":"loc-v7k","title":"Pre-filter files by known source extensions","description":"## Context\nCurrently aloc processes ALL non-binary files. Many files (logs, data, assets) are not source code and should be skipped.\n\n## Implementation\n1. Define list of known source extensions (from language.go)\n2. In walker, check extension before adding to paths channel\n3. Unknown extensions go through only in --deep mode\n\n## Known Source Extensions (from language.go)\nGo, TypeScript, JavaScript, Python, Java, Rust, C, C++, Shell, YAML, JSON, Markdown, HTML, CSS, SQL, Terraform, HCL, TOML, Dockerfile, Makefile, etc.\n\n## Behavior\n- Quick mode: Only process known extensions + known extensionless files\n- Deep mode: Process all non-binary files\n\n## Expected Impact\nFurther reduces syscalls by avoiding binary check on non-source files","status":"closed","priority":2,"issue_type":"task","owner":"rsnodgrass@gmail.com","created_at":"2026-01-17T08:04:20.637475-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-17T12:49:51.267892-08:00","closed_at":"2026-01-17T12:49:51.267892-08:00","close_reason":"Implemented: knownSourceExtensions map in walker.go with extension pre-filtering in quick mode"}
{"id":"loc-yb5","title":"Support all languages that tokei supports","description":"Audit tokei's language definitions and ensure ALOC supports the same set. This includes file extensions, comment markers (line and block), and special filenames. Reference: https://github.com/XAMPPRocky/tokei/tree/master/languages.toml","status":"open","priority":2,"issue_type":"feature","owner":"rsnodgrass@gmail.com","created_at":"2026-01-18T19:15:46.70072-08:00","created_by":"Ryan Snodgrass","updated_at":"2026-01-18T19:15:46.70072-08:00"}
